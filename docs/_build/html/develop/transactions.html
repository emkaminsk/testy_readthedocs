
<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

    <title>Transactions &#8212; Immudb 1.3.0 documentation</title>
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/alabaster.css" />
    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../_static/doctools.js"></script>
    <link rel="author" title="About these documents" href="../about.html" />
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
   
  <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <section id="transactions">
<h1>Transactions<a class="headerlink" href="#transactions" title="Permalink to this heading">¶</a></h1>
<p><code class="docutils literal notranslate"><span class="pre">GetAll</span></code>, <code class="docutils literal notranslate"><span class="pre">SetAll</span></code> and <code class="docutils literal notranslate"><span class="pre">ExecAll</span></code> are the foundation of transactions at key value level in immudb. They allow the execution of a group of commands in a single step, with two important guarantees:</p>
<ul class="simple">
<li><p>All the commands in a transaction are serialized and executed sequentially. No request issued by another client can ever interrupt the execution of a transaction. This guarantees that the commands are executed as a single isolated operation.</p></li>
<li><p>Either all of the commands are processed, or none are, so the transaction is also atomic.</p></li>
</ul>
<section id="getall">
<h2>GetAll<a class="headerlink" href="#getall" title="Permalink to this heading">¶</a></h2>
<p>:::: tabs</p>
<p>::: tab Go</p>
<div class="highlight-go notranslate"><div class="highlight"><pre><span></span><span class="kn">package</span><span class="w"> </span><span class="nx">main</span><span class="w"></span>

<span class="kn">import</span><span class="w"> </span><span class="p">(</span><span class="w"></span>
<span class="w">	</span><span class="s">&quot;context&quot;</span><span class="w"></span>
<span class="w">	</span><span class="s">&quot;log&quot;</span><span class="w"></span>

<span class="w">	</span><span class="nx">immudb</span><span class="w"> </span><span class="s">&quot;github.com/codenotary/immudb/pkg/client&quot;</span><span class="w"></span>
<span class="p">)</span><span class="w"></span>

<span class="kd">func</span><span class="w"> </span><span class="nx">main</span><span class="p">()</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">	</span><span class="nx">opts</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="nx">immudb</span><span class="p">.</span><span class="nx">DefaultOptions</span><span class="p">().</span><span class="nx">WithAddress</span><span class="p">(</span><span class="s">&quot;localhost&quot;</span><span class="p">).</span><span class="nx">WithPort</span><span class="p">(</span><span class="mi">3322</span><span class="p">)</span><span class="w"></span>
<span class="w">	</span><span class="nx">client</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="nx">immudb</span><span class="p">.</span><span class="nx">NewClient</span><span class="p">().</span><span class="nx">WithOptions</span><span class="p">(</span><span class="nx">opts</span><span class="p">)</span><span class="w"></span>
<span class="w">	</span><span class="nx">err</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="nx">client</span><span class="p">.</span><span class="nx">OpenSession</span><span class="p">(</span><span class="nx">context</span><span class="p">.</span><span class="nx">TODO</span><span class="p">(),</span><span class="w"> </span><span class="p">[]</span><span class="nb">byte</span><span class="p">(</span><span class="s">`immudb`</span><span class="p">),</span><span class="w"> </span><span class="p">[]</span><span class="nb">byte</span><span class="p">(</span><span class="s">`immudb`</span><span class="p">),</span><span class="w"> </span><span class="s">&quot;defaultdb&quot;</span><span class="p">)</span><span class="w"></span>
<span class="w">	</span><span class="k">if</span><span class="w"> </span><span class="nx">err</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="kc">nil</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">		</span><span class="nx">log</span><span class="p">.</span><span class="nx">Fatal</span><span class="p">(</span><span class="nx">err</span><span class="p">)</span><span class="w"></span>
<span class="w">	</span><span class="p">}</span><span class="w"></span>

<span class="w">	</span><span class="k">defer</span><span class="w"> </span><span class="nx">client</span><span class="p">.</span><span class="nx">CloseSession</span><span class="p">(</span><span class="nx">context</span><span class="p">.</span><span class="nx">TODO</span><span class="p">())</span><span class="w"></span>

<span class="w">	</span><span class="nx">_</span><span class="p">,</span><span class="w"> </span><span class="nx">err</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="nx">client</span><span class="p">.</span><span class="nx">Set</span><span class="p">(</span><span class="nx">context</span><span class="p">.</span><span class="nx">TODO</span><span class="p">(),</span><span class="w"> </span><span class="p">[]</span><span class="nb">byte</span><span class="p">(</span><span class="s">`key1`</span><span class="p">),</span><span class="w"> </span><span class="p">[]</span><span class="nb">byte</span><span class="p">(</span><span class="s">`val1`</span><span class="p">))</span><span class="w"></span>
<span class="w">	</span><span class="k">if</span><span class="w"> </span><span class="nx">err</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="kc">nil</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">		</span><span class="nx">log</span><span class="p">.</span><span class="nx">Fatal</span><span class="p">(</span><span class="nx">err</span><span class="p">)</span><span class="w"></span>
<span class="w">	</span><span class="p">}</span><span class="w"></span>
<span class="w">	</span><span class="nx">_</span><span class="p">,</span><span class="w"> </span><span class="nx">err</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="nx">client</span><span class="p">.</span><span class="nx">Set</span><span class="p">(</span><span class="nx">context</span><span class="p">.</span><span class="nx">TODO</span><span class="p">(),</span><span class="w"> </span><span class="p">[]</span><span class="nb">byte</span><span class="p">(</span><span class="s">`key2`</span><span class="p">),</span><span class="w"> </span><span class="p">[]</span><span class="nb">byte</span><span class="p">(</span><span class="s">`val2`</span><span class="p">))</span><span class="w"></span>
<span class="w">	</span><span class="k">if</span><span class="w"> </span><span class="nx">err</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="kc">nil</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">		</span><span class="nx">log</span><span class="p">.</span><span class="nx">Fatal</span><span class="p">(</span><span class="nx">err</span><span class="p">)</span><span class="w"></span>
<span class="w">	</span><span class="p">}</span><span class="w"></span>

<span class="w">	</span><span class="nx">itList</span><span class="p">,</span><span class="w"> </span><span class="nx">err</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="nx">client</span><span class="p">.</span><span class="nx">GetAll</span><span class="p">(</span><span class="nx">context</span><span class="p">.</span><span class="nx">TODO</span><span class="p">(),</span><span class="w"> </span><span class="p">[][]</span><span class="kt">byte</span><span class="p">{</span><span class="w"></span>
<span class="w">		</span><span class="p">[]</span><span class="nb">byte</span><span class="p">(</span><span class="s">&quot;key1&quot;</span><span class="p">),</span><span class="w"></span>
<span class="w">		</span><span class="p">[]</span><span class="nb">byte</span><span class="p">(</span><span class="s">&quot;key2&quot;</span><span class="p">),</span><span class="w"></span>
<span class="w">		</span><span class="p">[]</span><span class="nb">byte</span><span class="p">(</span><span class="s">&quot;key3&quot;</span><span class="p">),</span><span class="w"> </span><span class="c1">// does not exist, no value returned</span><span class="w"></span>
<span class="w">	</span><span class="p">})</span><span class="w"></span>

<span class="w">	</span><span class="nx">log</span><span class="p">.</span><span class="nx">Printf</span><span class="p">(</span><span class="s">&quot;Set: tx: %+v&quot;</span><span class="p">,</span><span class="w"> </span><span class="nx">itList</span><span class="p">)</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
</pre></div>
</div>
<p>:::</p>
<p>::: tab Python</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">immudb</span> <span class="kn">import</span> <span class="n">ImmudbClient</span>

<span class="n">URL</span> <span class="o">=</span> <span class="s2">&quot;localhost:3322&quot;</span>  <span class="c1"># immudb running on your machine</span>
<span class="n">LOGIN</span> <span class="o">=</span> <span class="s2">&quot;immudb&quot;</span>        <span class="c1"># Default username</span>
<span class="n">PASSWORD</span> <span class="o">=</span> <span class="s2">&quot;immudb&quot;</span>     <span class="c1"># Default password</span>
<span class="n">DB</span> <span class="o">=</span> <span class="sa">b</span><span class="s2">&quot;defaultdb&quot;</span>       <span class="c1"># Default database name (must be in bytes)</span>

<span class="k">def</span> <span class="nf">main</span><span class="p">():</span>
    <span class="n">client</span> <span class="o">=</span> <span class="n">ImmudbClient</span><span class="p">(</span><span class="n">URL</span><span class="p">)</span>
    <span class="n">client</span><span class="o">.</span><span class="n">login</span><span class="p">(</span><span class="n">LOGIN</span><span class="p">,</span> <span class="n">PASSWORD</span><span class="p">,</span> <span class="n">database</span> <span class="o">=</span> <span class="n">DB</span><span class="p">)</span>

    <span class="n">client</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="sa">b</span><span class="s1">&#39;key1&#39;</span><span class="p">,</span> <span class="sa">b</span><span class="s1">&#39;value1&#39;</span><span class="p">)</span>
    <span class="n">client</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="sa">b</span><span class="s1">&#39;key2&#39;</span><span class="p">,</span> <span class="sa">b</span><span class="s1">&#39;value2&#39;</span><span class="p">)</span>
    <span class="n">client</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="sa">b</span><span class="s1">&#39;key3&#39;</span><span class="p">,</span> <span class="sa">b</span><span class="s1">&#39;value3&#39;</span><span class="p">)</span>
    
    <span class="n">response</span> <span class="o">=</span> <span class="n">client</span><span class="o">.</span><span class="n">getAll</span><span class="p">([</span><span class="sa">b</span><span class="s1">&#39;key1&#39;</span><span class="p">,</span> <span class="sa">b</span><span class="s1">&#39;key2&#39;</span><span class="p">,</span> <span class="sa">b</span><span class="s1">&#39;key3&#39;</span><span class="p">])</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">response</span><span class="p">)</span> <span class="c1"># The same as dictToSetGet, retrieved in one step</span>

<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>
    <span class="n">main</span><span class="p">()</span>
</pre></div>
</div>
<p>:::</p>
<p>::: tab Java</p>
<div class="highlight-java notranslate"><div class="highlight"><pre><span></span><span class="c1">// Using getAll:</span><span class="w"></span>
<span class="n">List</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;</span><span class="w"> </span><span class="n">keys</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Arrays</span><span class="p">.</span><span class="na">asList</span><span class="p">(</span><span class="s">&quot;key1&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;key2&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;key3&quot;</span><span class="p">);</span><span class="w"></span>
<span class="n">List</span><span class="o">&lt;</span><span class="n">KV</span><span class="o">&gt;</span><span class="w"> </span><span class="n">got</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">immuClient</span><span class="p">.</span><span class="na">getAll</span><span class="p">(</span><span class="n">keys</span><span class="p">);</span><span class="w"></span>

<span class="c1">// Using execAll for setting multiple KVs at once:</span><span class="w"></span>
<span class="kt">byte</span><span class="o">[]</span><span class="w"> </span><span class="n">item1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;execAll_key1&quot;</span><span class="p">.</span><span class="na">getBytes</span><span class="p">(</span><span class="n">StandardCharsets</span><span class="p">.</span><span class="na">UTF_8</span><span class="p">);</span><span class="w"></span>
<span class="kt">byte</span><span class="o">[]</span><span class="w"> </span><span class="n">item2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;execAll_key2&quot;</span><span class="p">.</span><span class="na">getBytes</span><span class="p">(</span><span class="n">StandardCharsets</span><span class="p">.</span><span class="na">UTF_8</span><span class="p">);</span><span class="w"></span>

<span class="n">immuClient</span><span class="p">.</span><span class="na">execAll</span><span class="p">(</span><span class="w"></span>
<span class="w">        </span><span class="n">Arrays</span><span class="p">.</span><span class="na">asList</span><span class="p">(</span><span class="w">                  </span><span class="c1">// Providing just a kvList, which is a List&lt; Pair&lt;byte[], byte[]&gt; &gt;.</span><span class="w"></span>
<span class="w">                </span><span class="n">Pair</span><span class="p">.</span><span class="na">of</span><span class="p">(</span><span class="n">item1</span><span class="p">,</span><span class="w"> </span><span class="n">item1</span><span class="p">),</span><span class="w"></span>
<span class="w">                </span><span class="n">Pair</span><span class="p">.</span><span class="na">of</span><span class="p">(</span><span class="n">item2</span><span class="p">,</span><span class="w"> </span><span class="n">item2</span><span class="p">)</span><span class="w"></span>
<span class="w">        </span><span class="p">),</span><span class="w"></span>
<span class="w">        </span><span class="kc">null</span><span class="p">,</span><span class="w">                          </span><span class="c1">// No refList provided.</span><span class="w"></span>
<span class="w">        </span><span class="kc">null</span><span class="w">                           </span><span class="c1">// No zaddList provided.</span><span class="w"></span>
<span class="p">);</span><span class="w"></span>

<span class="c1">// Using execAll for setting multiple references and doing zAdd(s):</span><span class="w"></span>
<span class="n">immuClient</span><span class="p">.</span><span class="na">execAll</span><span class="p">(</span><span class="w"></span>
<span class="w">        </span><span class="kc">null</span><span class="p">,</span><span class="w">                          </span><span class="c1">// No kvList provided.</span><span class="w"></span>
<span class="w">        </span><span class="n">Arrays</span><span class="p">.</span><span class="na">asList</span><span class="p">(</span><span class="w">                 </span><span class="c1">// The refList.</span><span class="w"></span>
<span class="w">                </span><span class="n">Pair</span><span class="p">.</span><span class="na">of</span><span class="p">(</span><span class="s">&quot;ref1&quot;</span><span class="p">.</span><span class="na">getBytes</span><span class="p">(</span><span class="n">StandardCharsets</span><span class="p">.</span><span class="na">UTF_8</span><span class="p">),</span><span class="w"> </span><span class="n">item1</span><span class="p">),</span><span class="w"></span>
<span class="w">                </span><span class="n">Pair</span><span class="p">.</span><span class="na">of</span><span class="p">(</span><span class="s">&quot;ref2&quot;</span><span class="p">.</span><span class="na">getBytes</span><span class="p">(</span><span class="n">StandardCharsets</span><span class="p">.</span><span class="na">UTF_8</span><span class="p">),</span><span class="w"> </span><span class="n">item2</span><span class="p">)</span><span class="w"></span>
<span class="w">        </span><span class="p">),</span><span class="w"></span>
<span class="w">        </span><span class="c1">// The zaddList.</span><span class="w"></span>
<span class="w">        </span><span class="n">Collections</span><span class="p">.</span><span class="na">singletonList</span><span class="p">(</span><span class="n">Triple</span><span class="p">.</span><span class="na">of</span><span class="p">(</span><span class="s">&quot;set1&quot;</span><span class="p">,</span><span class="w"> </span><span class="mf">1.0</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;execAll_key1&quot;</span><span class="p">))</span><span class="w"></span>
<span class="p">);</span><span class="w"></span>
</pre></div>
</div>
<p>:::</p>
<p>::: tab Node.js</p>
<div class="highlight-ts notranslate"><div class="highlight"><pre><span></span><span class="k">import</span><span class="w"> </span><span class="nx">ImmudbClient</span><span class="w"> </span><span class="kr">from</span><span class="w"> </span><span class="s1">&#39;immudb-node&#39;</span><span class="w"></span>
<span class="k">import</span><span class="w"> </span><span class="nx">Parameters</span><span class="w"> </span><span class="kr">from</span><span class="w"> </span><span class="s1">&#39;immudb-node/types/parameters&#39;</span><span class="w"></span>

<span class="kd">const</span><span class="w"> </span><span class="nx">IMMUDB_HOST</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;127.0.0.1&#39;</span><span class="w"></span>
<span class="kd">const</span><span class="w"> </span><span class="nx">IMMUDB_PORT</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;3322&#39;</span><span class="w"></span>
<span class="kd">const</span><span class="w"> </span><span class="nx">IMMUDB_USER</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;immudb&#39;</span><span class="w"></span>
<span class="kd">const</span><span class="w"> </span><span class="nx">IMMUDB_PWD</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;immudb&#39;</span><span class="w"></span>

<span class="kd">const</span><span class="w"> </span><span class="nx">cl</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="nx">ImmudbClient</span><span class="p">({</span><span class="w"> </span><span class="nx">host</span><span class="o">:</span><span class="w"> </span><span class="kt">IMMUDB_HOST</span><span class="p">,</span><span class="w"> </span><span class="nx">port</span><span class="o">:</span><span class="w"> </span><span class="kt">IMMUDB_PORT</span><span class="w"> </span><span class="p">});</span><span class="w"></span>

<span class="p">(</span><span class="k">async</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w"> </span><span class="k">await</span><span class="w"> </span><span class="nx">cl</span><span class="p">.</span><span class="nx">login</span><span class="p">({</span><span class="w"> </span><span class="nx">user</span><span class="o">:</span><span class="w"> </span><span class="kt">IMMUDB_USER</span><span class="p">,</span><span class="w"> </span><span class="nx">password</span><span class="o">:</span><span class="w"> </span><span class="kt">IMMUDB_PWD</span><span class="w"> </span><span class="p">})</span><span class="w"></span>

<span class="w"> </span><span class="kd">const</span><span class="w"> </span><span class="nx">getAllReq</span><span class="o">:</span><span class="w"> </span><span class="kt">Parameters.GetAll</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">  </span><span class="nx">keysList</span><span class="o">:</span><span class="w"> </span><span class="p">[</span><span class="s1">&#39;key1&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;key2&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;key3&#39;</span><span class="p">],</span><span class="w"></span>
<span class="w">  </span><span class="nx">sincetx</span><span class="o">:</span><span class="w"> </span><span class="kt">0</span><span class="w"></span>
<span class="w"> </span><span class="p">}</span><span class="w"></span>
<span class="w"> </span><span class="kd">const</span><span class="w"> </span><span class="nx">getAllRes</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">await</span><span class="w"> </span><span class="nx">cl</span><span class="p">.</span><span class="nx">getAll</span><span class="p">(</span><span class="nx">getAllReq</span><span class="p">)</span><span class="w"></span>
<span class="w"> </span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;success: getAll&#39;</span><span class="p">,</span><span class="w"> </span><span class="nx">getAllRes</span><span class="p">)</span><span class="w"></span>
<span class="p">})()</span><span class="w"></span>
</pre></div>
</div>
<p>:::</p>
<p>::: tab Others
If you’re using another development language, please refer to the <a class="reference internal" href="immugw.html"><span class="doc std std-doc">immugw</span></a> option.
:::</p>
<p>::::</p>
</section>
<section id="setall">
<h2>SetAll<a class="headerlink" href="#setall" title="Permalink to this heading">¶</a></h2>
<p>A more versatile atomic multi set operation
:::: tabs
SetBatch and GetBatch example
::: tab Go</p>
<div class="highlight-go notranslate"><div class="highlight"><pre><span></span><span class="kn">package</span><span class="w"> </span><span class="nx">main</span><span class="w"></span>

<span class="kn">import</span><span class="w"> </span><span class="p">(</span><span class="w"></span>
<span class="w">	</span><span class="s">&quot;context&quot;</span><span class="w"></span>
<span class="w">	</span><span class="s">&quot;log&quot;</span><span class="w"></span>

<span class="w">	</span><span class="s">&quot;github.com/codenotary/immudb/pkg/api/schema&quot;</span><span class="w"></span>
<span class="w">	</span><span class="nx">immudb</span><span class="w"> </span><span class="s">&quot;github.com/codenotary/immudb/pkg/client&quot;</span><span class="w"></span>
<span class="p">)</span><span class="w"></span>

<span class="kd">func</span><span class="w"> </span><span class="nx">main</span><span class="p">()</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">	</span><span class="nx">opts</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="nx">immudb</span><span class="p">.</span><span class="nx">DefaultOptions</span><span class="p">().</span><span class="nx">WithAddress</span><span class="p">(</span><span class="s">&quot;localhost&quot;</span><span class="p">).</span><span class="nx">WithPort</span><span class="p">(</span><span class="mi">3322</span><span class="p">)</span><span class="w"></span>
<span class="w">	</span><span class="nx">client</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="nx">immudb</span><span class="p">.</span><span class="nx">NewClient</span><span class="p">().</span><span class="nx">WithOptions</span><span class="p">(</span><span class="nx">opts</span><span class="p">)</span><span class="w"></span>
<span class="w">	</span><span class="nx">err</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="nx">client</span><span class="p">.</span><span class="nx">OpenSession</span><span class="p">(</span><span class="nx">context</span><span class="p">.</span><span class="nx">TODO</span><span class="p">(),</span><span class="w"> </span><span class="p">[]</span><span class="nb">byte</span><span class="p">(</span><span class="s">`immudb`</span><span class="p">),</span><span class="w"> </span><span class="p">[]</span><span class="nb">byte</span><span class="p">(</span><span class="s">`immudb`</span><span class="p">),</span><span class="w"> </span><span class="s">&quot;defaultdb&quot;</span><span class="p">)</span><span class="w"></span>
<span class="w">	</span><span class="k">if</span><span class="w"> </span><span class="nx">err</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="kc">nil</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">		</span><span class="nx">log</span><span class="p">.</span><span class="nx">Fatal</span><span class="p">(</span><span class="nx">err</span><span class="p">)</span><span class="w"></span>
<span class="w">	</span><span class="p">}</span><span class="w"></span>

<span class="w">	</span><span class="k">defer</span><span class="w"> </span><span class="nx">client</span><span class="p">.</span><span class="nx">CloseSession</span><span class="p">(</span><span class="nx">context</span><span class="p">.</span><span class="nx">TODO</span><span class="p">())</span><span class="w"></span>

<span class="w">	</span><span class="nx">tx</span><span class="p">,</span><span class="w"> </span><span class="nx">err</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="nx">client</span><span class="p">.</span><span class="nx">SetAll</span><span class="p">(</span><span class="nx">context</span><span class="p">.</span><span class="nx">TODO</span><span class="p">(),</span><span class="w"> </span><span class="o">&amp;</span><span class="nx">schema</span><span class="p">.</span><span class="nx">SetRequest</span><span class="p">{</span><span class="w"></span>
<span class="w">		</span><span class="nx">KVs</span><span class="p">:</span><span class="w"> </span><span class="p">[]</span><span class="o">*</span><span class="nx">schema</span><span class="p">.</span><span class="nx">KeyValue</span><span class="p">{</span><span class="w"></span>
<span class="w">			</span><span class="p">{</span><span class="nx">Key</span><span class="p">:</span><span class="w"> </span><span class="p">[]</span><span class="nb">byte</span><span class="p">(</span><span class="s">`1`</span><span class="p">),</span><span class="w"> </span><span class="nx">Value</span><span class="p">:</span><span class="w"> </span><span class="p">[]</span><span class="nb">byte</span><span class="p">(</span><span class="s">`key1`</span><span class="p">)},</span><span class="w"></span>
<span class="w">			</span><span class="p">{</span><span class="nx">Key</span><span class="p">:</span><span class="w"> </span><span class="p">[]</span><span class="nb">byte</span><span class="p">(</span><span class="s">`2`</span><span class="p">),</span><span class="w"> </span><span class="nx">Value</span><span class="p">:</span><span class="w"> </span><span class="p">[]</span><span class="nb">byte</span><span class="p">(</span><span class="s">`key2`</span><span class="p">)},</span><span class="w"></span>
<span class="w">			</span><span class="p">{</span><span class="nx">Key</span><span class="p">:</span><span class="w"> </span><span class="p">[]</span><span class="nb">byte</span><span class="p">(</span><span class="s">`3`</span><span class="p">),</span><span class="w"> </span><span class="nx">Value</span><span class="p">:</span><span class="w"> </span><span class="p">[]</span><span class="nb">byte</span><span class="p">(</span><span class="s">`key3`</span><span class="p">)},</span><span class="w"></span>
<span class="w">		</span><span class="p">},</span><span class="w"></span>
<span class="w">	</span><span class="p">})</span><span class="w"></span>
<span class="w">	</span><span class="k">if</span><span class="w"> </span><span class="nx">err</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="kc">nil</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">		</span><span class="nx">log</span><span class="p">.</span><span class="nx">Fatal</span><span class="p">(</span><span class="nx">err</span><span class="p">)</span><span class="w"></span>
<span class="w">	</span><span class="p">}</span><span class="w"></span>
<span class="w">	</span><span class="nx">log</span><span class="p">.</span><span class="nx">Printf</span><span class="p">(</span><span class="s">&quot;SetAll: tx: %d&quot;</span><span class="p">,</span><span class="w"> </span><span class="nx">tx</span><span class="p">.</span><span class="nx">Id</span><span class="p">)</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
</pre></div>
</div>
<p>:::</p>
<p>::: tab Python</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">immudb</span> <span class="kn">import</span> <span class="n">ImmudbClient</span>

<span class="n">URL</span> <span class="o">=</span> <span class="s2">&quot;localhost:3322&quot;</span>  <span class="c1"># immudb running on your machine</span>
<span class="n">LOGIN</span> <span class="o">=</span> <span class="s2">&quot;immudb&quot;</span>        <span class="c1"># Default username</span>
<span class="n">PASSWORD</span> <span class="o">=</span> <span class="s2">&quot;immudb&quot;</span>     <span class="c1"># Default password</span>
<span class="n">DB</span> <span class="o">=</span> <span class="sa">b</span><span class="s2">&quot;defaultdb&quot;</span>       <span class="c1"># Default database name (must be in bytes)</span>

<span class="k">def</span> <span class="nf">main</span><span class="p">():</span>
    <span class="n">client</span> <span class="o">=</span> <span class="n">ImmudbClient</span><span class="p">(</span><span class="n">URL</span><span class="p">)</span>
    <span class="n">client</span><span class="o">.</span><span class="n">login</span><span class="p">(</span><span class="n">LOGIN</span><span class="p">,</span> <span class="n">PASSWORD</span><span class="p">,</span> <span class="n">database</span> <span class="o">=</span> <span class="n">DB</span><span class="p">)</span>
    <span class="n">dictToSetGet</span> <span class="o">=</span> <span class="p">{</span>
        <span class="sa">b</span><span class="s1">&#39;key1&#39;</span><span class="p">:</span> <span class="sa">b</span><span class="s1">&#39;value1&#39;</span><span class="p">,</span>
        <span class="sa">b</span><span class="s1">&#39;key2&#39;</span><span class="p">:</span> <span class="sa">b</span><span class="s1">&#39;value2&#39;</span><span class="p">,</span>
        <span class="sa">b</span><span class="s1">&#39;key3&#39;</span><span class="p">:</span> <span class="sa">b</span><span class="s1">&#39;value3&#39;</span>
    <span class="p">}</span>
    <span class="n">response</span> <span class="o">=</span> <span class="n">client</span><span class="o">.</span><span class="n">setAll</span><span class="p">(</span><span class="n">dictToSetGet</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">response</span><span class="o">.</span><span class="n">id</span><span class="p">)</span> <span class="c1"># All in one transaction</span>

    <span class="n">response</span> <span class="o">=</span> <span class="n">client</span><span class="o">.</span><span class="n">getAll</span><span class="p">([</span><span class="sa">b</span><span class="s1">&#39;key1&#39;</span><span class="p">,</span> <span class="sa">b</span><span class="s1">&#39;key2&#39;</span><span class="p">,</span> <span class="sa">b</span><span class="s1">&#39;key3&#39;</span><span class="p">])</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">response</span><span class="p">)</span> <span class="c1"># The same as dictToSetGet, retrieved in one step</span>

<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>
    <span class="n">main</span><span class="p">()</span>
</pre></div>
</div>
<p>:::</p>
<p>::: tab Java</p>
<div class="highlight-java notranslate"><div class="highlight"><pre><span></span><span class="n">List</span><span class="o">&lt;</span><span class="n">KV</span><span class="o">&gt;</span><span class="w"> </span><span class="n">kvs</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Arrays</span><span class="p">.</span><span class="na">asList</span><span class="p">(</span><span class="w"></span>
<span class="w">    </span><span class="k">new</span><span class="w"> </span><span class="n">KVPair</span><span class="p">(</span><span class="s">&quot;key1&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;val1&quot;</span><span class="p">.</span><span class="na">getBytes</span><span class="p">(</span><span class="n">StandardCharsets</span><span class="p">.</span><span class="na">UTF_8</span><span class="p">)),</span><span class="w"></span>
<span class="w">    </span><span class="k">new</span><span class="w"> </span><span class="n">KVPair</span><span class="p">(</span><span class="s">&quot;key2&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;val2&quot;</span><span class="p">.</span><span class="na">getBytes</span><span class="p">(</span><span class="n">StandardCharsets</span><span class="p">.</span><span class="na">UTF_8</span><span class="p">)),</span><span class="w"></span>
<span class="p">);</span><span class="w"></span>

<span class="n">KVList</span><span class="w"> </span><span class="n">kvList</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">KVList</span><span class="p">.</span><span class="na">newBuilder</span><span class="p">().</span><span class="na">addAll</span><span class="p">(</span><span class="n">kvs</span><span class="p">).</span><span class="na">build</span><span class="p">();</span><span class="w"></span>
<span class="k">try</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="n">immuClient</span><span class="p">.</span><span class="na">setAll</span><span class="p">(</span><span class="n">kvList</span><span class="p">);</span><span class="w"></span>
<span class="p">}</span><span class="w"> </span><span class="k">catch</span><span class="w"> </span><span class="p">(</span><span class="n">CorruptedDataException</span><span class="w"> </span><span class="n">e</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="c1">// ...</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
</pre></div>
</div>
<p>:::</p>
<p>::: tab Node.js</p>
<div class="highlight-ts notranslate"><div class="highlight"><pre><span></span><span class="k">import</span><span class="w"> </span><span class="nx">ImmudbClient</span><span class="w"> </span><span class="kr">from</span><span class="w"> </span><span class="s1">&#39;immudb-node&#39;</span><span class="w"></span>
<span class="k">import</span><span class="w"> </span><span class="nx">Parameters</span><span class="w"> </span><span class="kr">from</span><span class="w"> </span><span class="s1">&#39;immudb-node/types/parameters&#39;</span><span class="w"></span>

<span class="kd">const</span><span class="w"> </span><span class="nx">IMMUDB_HOST</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;127.0.0.1&#39;</span><span class="w"></span>
<span class="kd">const</span><span class="w"> </span><span class="nx">IMMUDB_PORT</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;3322&#39;</span><span class="w"></span>
<span class="kd">const</span><span class="w"> </span><span class="nx">IMMUDB_USER</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;immudb&#39;</span><span class="w"></span>
<span class="kd">const</span><span class="w"> </span><span class="nx">IMMUDB_PWD</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;immudb&#39;</span><span class="w"></span>

<span class="kd">const</span><span class="w"> </span><span class="nx">cl</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="nx">ImmudbClient</span><span class="p">({</span><span class="w"> </span><span class="nx">host</span><span class="o">:</span><span class="w"> </span><span class="kt">IMMUDB_HOST</span><span class="p">,</span><span class="w"> </span><span class="nx">port</span><span class="o">:</span><span class="w"> </span><span class="kt">IMMUDB_PORT</span><span class="w"> </span><span class="p">});</span><span class="w"></span>

<span class="p">(</span><span class="k">async</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w"> </span><span class="k">await</span><span class="w"> </span><span class="nx">cl</span><span class="p">.</span><span class="nx">login</span><span class="p">({</span><span class="w"> </span><span class="nx">user</span><span class="o">:</span><span class="w"> </span><span class="kt">IMMUDB_USER</span><span class="p">,</span><span class="w"> </span><span class="nx">password</span><span class="o">:</span><span class="w"> </span><span class="kt">IMMUDB_PWD</span><span class="w"> </span><span class="p">})</span><span class="w"></span>

<span class="w"> </span><span class="kd">const</span><span class="w"> </span><span class="nx">setAllReq</span><span class="o">:</span><span class="w"> </span><span class="kt">Parameters.SetAll</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">  </span><span class="nx">kvsList</span><span class="o">:</span><span class="w"> </span><span class="p">[</span><span class="w"></span>
<span class="w">   </span><span class="p">{</span><span class="w"> </span><span class="nx">key</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;1,2,3&#39;</span><span class="p">,</span><span class="w"> </span><span class="nx">value</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;3,2,1&#39;</span><span class="w"> </span><span class="p">},</span><span class="w"></span>
<span class="w">   </span><span class="p">{</span><span class="w"> </span><span class="nx">key</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;4,5,6&#39;</span><span class="p">,</span><span class="w"> </span><span class="nx">value</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;6,5,4&#39;</span><span class="w"> </span><span class="p">},</span><span class="w"></span>
<span class="w">  </span><span class="p">]</span><span class="w"></span>
<span class="w"> </span><span class="p">}</span><span class="w"></span>
<span class="w"> </span><span class="kd">const</span><span class="w"> </span><span class="nx">setAllRes</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">await</span><span class="w"> </span><span class="nx">cl</span><span class="p">.</span><span class="nx">setAll</span><span class="p">(</span><span class="nx">setAllReq</span><span class="p">)</span><span class="w"></span>
<span class="w"> </span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;success: setAll&#39;</span><span class="p">,</span><span class="w"> </span><span class="nx">setAllRes</span><span class="p">)</span><span class="w"></span>
<span class="p">})()</span><span class="w"></span>
</pre></div>
</div>
<p>:::</p>
<p>::: tab Others
If you’re using another development language, please refer to the <a class="reference internal" href="immugw.html"><span class="doc std std-doc">immugw</span></a> option.
:::</p>
<p>::::</p>
</section>
<section id="execall">
<h2>ExecAll<a class="headerlink" href="#execall" title="Permalink to this heading">¶</a></h2>
<p><code class="docutils literal notranslate"><span class="pre">ExecAll</span></code> allows multiple insertions at once. The difference is that it is possible to specify a list of mixes of key/value sets, references and <code class="docutils literal notranslate"><span class="pre">zAdd</span></code> insertions.
The argument of a <code class="docutils literal notranslate"><span class="pre">ExecAll</span></code> is an array of the following types:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">Op_Kv</span></code>: ordinary key value item</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">Op_ZAdd</span></code>: <span class="xref myst">ZAdd</span> option element</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">Op_Ref</span></code>: <span class="xref myst">Reference</span> option element</p></li>
</ul>
<p>It’s possible to persist and reference items that are already persisted on disk. In that case is mandatory to provide the index of the referenced item. This has to be done for:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">Op_ZAdd</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">Op_Ref</span></code>
If <code class="docutils literal notranslate"><span class="pre">zAdd</span></code> or <code class="docutils literal notranslate"><span class="pre">reference</span></code> is not yet persisted on disk it’s possible to add it as a regular key value and the reference is done only. In that case if <code class="docutils literal notranslate"><span class="pre">BoundRef</span></code> is true the reference is bounded to the current transaction values.</p></li>
</ul>
<p>:::: tabs</p>
<p>::: tab Go</p>
<div class="highlight-go notranslate"><div class="highlight"><pre><span></span><span class="kn">package</span><span class="w"> </span><span class="nx">main</span><span class="w"></span>

<span class="kn">import</span><span class="w"> </span><span class="p">(</span><span class="w"></span>
<span class="w">	</span><span class="s">&quot;context&quot;</span><span class="w"></span>
<span class="w">	</span><span class="s">&quot;encoding/json&quot;</span><span class="w"></span>
<span class="w">	</span><span class="s">&quot;log&quot;</span><span class="w"></span>

<span class="w">	</span><span class="s">&quot;github.com/codenotary/immudb/pkg/api/schema&quot;</span><span class="w"></span>
<span class="w">	</span><span class="nx">immudb</span><span class="w"> </span><span class="s">&quot;github.com/codenotary/immudb/pkg/client&quot;</span><span class="w"></span>
<span class="p">)</span><span class="w"></span>

<span class="kd">func</span><span class="w"> </span><span class="nx">main</span><span class="p">()</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">	</span><span class="nx">opts</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="nx">immudb</span><span class="p">.</span><span class="nx">DefaultOptions</span><span class="p">().</span><span class="nx">WithAddress</span><span class="p">(</span><span class="s">&quot;localhost&quot;</span><span class="p">).</span><span class="nx">WithPort</span><span class="p">(</span><span class="mi">3322</span><span class="p">)</span><span class="w"></span>
<span class="w">	</span><span class="nx">client</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="nx">immudb</span><span class="p">.</span><span class="nx">NewClient</span><span class="p">().</span><span class="nx">WithOptions</span><span class="p">(</span><span class="nx">opts</span><span class="p">)</span><span class="w"></span>
<span class="w">	</span><span class="nx">err</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="nx">client</span><span class="p">.</span><span class="nx">OpenSession</span><span class="p">(</span><span class="nx">context</span><span class="p">.</span><span class="nx">TODO</span><span class="p">(),</span><span class="w"> </span><span class="p">[]</span><span class="nb">byte</span><span class="p">(</span><span class="s">`immudb`</span><span class="p">),</span><span class="w"> </span><span class="p">[]</span><span class="nb">byte</span><span class="p">(</span><span class="s">`immudb`</span><span class="p">),</span><span class="w"> </span><span class="s">&quot;defaultdb&quot;</span><span class="p">)</span><span class="w"></span>
<span class="w">	</span><span class="k">if</span><span class="w"> </span><span class="nx">err</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="kc">nil</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">		</span><span class="nx">log</span><span class="p">.</span><span class="nx">Fatal</span><span class="p">(</span><span class="nx">err</span><span class="p">)</span><span class="w"></span>
<span class="w">	</span><span class="p">}</span><span class="w"></span>

<span class="w">	</span><span class="k">defer</span><span class="w"> </span><span class="nx">client</span><span class="p">.</span><span class="nx">CloseSession</span><span class="p">(</span><span class="nx">context</span><span class="p">.</span><span class="nx">TODO</span><span class="p">())</span><span class="w"></span>

<span class="w">	</span><span class="nx">idx</span><span class="p">,</span><span class="w"> </span><span class="nx">err</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="nx">client</span><span class="p">.</span><span class="nx">Set</span><span class="p">(</span><span class="nx">context</span><span class="p">.</span><span class="nx">TODO</span><span class="p">(),</span><span class="w"> </span><span class="p">[]</span><span class="nb">byte</span><span class="p">(</span><span class="s">`persistedKey`</span><span class="p">),</span><span class="w"> </span><span class="p">[]</span><span class="nb">byte</span><span class="p">(</span><span class="s">`persistedVal`</span><span class="p">))</span><span class="w"></span>
<span class="w">	</span><span class="k">if</span><span class="w"> </span><span class="nx">err</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="kc">nil</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">		</span><span class="nx">log</span><span class="p">.</span><span class="nx">Fatal</span><span class="p">(</span><span class="nx">err</span><span class="p">)</span><span class="w"></span>
<span class="w">	</span><span class="p">}</span><span class="w"></span>

<span class="w">	</span><span class="nx">aOps</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="o">&amp;</span><span class="nx">schema</span><span class="p">.</span><span class="nx">ExecAllRequest</span><span class="p">{</span><span class="w"></span>
<span class="w">		</span><span class="nx">Operations</span><span class="p">:</span><span class="w"> </span><span class="p">[]</span><span class="o">*</span><span class="nx">schema</span><span class="p">.</span><span class="nx">Op</span><span class="p">{</span><span class="w"></span>
<span class="w">			</span><span class="p">{</span><span class="w"></span>
<span class="w">				</span><span class="nx">Operation</span><span class="p">:</span><span class="w"> </span><span class="o">&amp;</span><span class="nx">schema</span><span class="p">.</span><span class="nx">Op_Kv</span><span class="p">{</span><span class="w"></span>
<span class="w">					</span><span class="nx">Kv</span><span class="p">:</span><span class="w"> </span><span class="o">&amp;</span><span class="nx">schema</span><span class="p">.</span><span class="nx">KeyValue</span><span class="p">{</span><span class="w"></span>
<span class="w">						</span><span class="nx">Key</span><span class="p">:</span><span class="w">   </span><span class="p">[]</span><span class="nb">byte</span><span class="p">(</span><span class="s">`notPersistedKey`</span><span class="p">),</span><span class="w"></span>
<span class="w">						</span><span class="nx">Value</span><span class="p">:</span><span class="w"> </span><span class="p">[]</span><span class="nb">byte</span><span class="p">(</span><span class="s">`notPersistedVal`</span><span class="p">),</span><span class="w"></span>
<span class="w">					</span><span class="p">},</span><span class="w"></span>
<span class="w">				</span><span class="p">},</span><span class="w"></span>
<span class="w">			</span><span class="p">},</span><span class="w"></span>
<span class="w">			</span><span class="p">{</span><span class="w"></span>
<span class="w">				</span><span class="nx">Operation</span><span class="p">:</span><span class="w"> </span><span class="o">&amp;</span><span class="nx">schema</span><span class="p">.</span><span class="nx">Op_ZAdd</span><span class="p">{</span><span class="w"></span>
<span class="w">					</span><span class="nx">ZAdd</span><span class="p">:</span><span class="w"> </span><span class="o">&amp;</span><span class="nx">schema</span><span class="p">.</span><span class="nx">ZAddRequest</span><span class="p">{</span><span class="w"></span>
<span class="w">						</span><span class="nx">Set</span><span class="p">:</span><span class="w">   </span><span class="p">[]</span><span class="nb">byte</span><span class="p">(</span><span class="s">`mySet`</span><span class="p">),</span><span class="w"></span>
<span class="w">						</span><span class="nx">Score</span><span class="p">:</span><span class="w"> </span><span class="mf">0.4</span><span class="p">,</span><span class="w"></span>
<span class="w">						</span><span class="nx">Key</span><span class="p">:</span><span class="w">   </span><span class="p">[]</span><span class="nb">byte</span><span class="p">(</span><span class="s">`notPersistedKey`</span><span class="p">)},</span><span class="w"></span>
<span class="w">				</span><span class="p">},</span><span class="w"></span>
<span class="w">			</span><span class="p">},</span><span class="w"></span>
<span class="w">			</span><span class="p">{</span><span class="w"></span>
<span class="w">				</span><span class="nx">Operation</span><span class="p">:</span><span class="w"> </span><span class="o">&amp;</span><span class="nx">schema</span><span class="p">.</span><span class="nx">Op_ZAdd</span><span class="p">{</span><span class="w"></span>
<span class="w">					</span><span class="nx">ZAdd</span><span class="p">:</span><span class="w"> </span><span class="o">&amp;</span><span class="nx">schema</span><span class="p">.</span><span class="nx">ZAddRequest</span><span class="p">{</span><span class="w"></span>
<span class="w">						</span><span class="nx">Set</span><span class="p">:</span><span class="w">      </span><span class="p">[]</span><span class="nb">byte</span><span class="p">(</span><span class="s">`mySet`</span><span class="p">),</span><span class="w"></span>
<span class="w">						</span><span class="nx">Score</span><span class="p">:</span><span class="w">    </span><span class="mf">0.6</span><span class="p">,</span><span class="w"></span>
<span class="w">						</span><span class="nx">Key</span><span class="p">:</span><span class="w">      </span><span class="p">[]</span><span class="nb">byte</span><span class="p">(</span><span class="s">`persistedKey`</span><span class="p">),</span><span class="w"></span>
<span class="w">						</span><span class="nx">AtTx</span><span class="p">:</span><span class="w">     </span><span class="nx">idx</span><span class="p">.</span><span class="nx">Id</span><span class="p">,</span><span class="w"></span>
<span class="w">						</span><span class="nx">BoundRef</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w"></span>
<span class="w">					</span><span class="p">},</span><span class="w"></span>
<span class="w">				</span><span class="p">},</span><span class="w"></span>
<span class="w">			</span><span class="p">},</span><span class="w"></span>
<span class="w">		</span><span class="p">},</span><span class="w"></span>
<span class="w">	</span><span class="p">}</span><span class="w"></span>

<span class="w">	</span><span class="nx">idx</span><span class="p">,</span><span class="w"> </span><span class="nx">err</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="nx">client</span><span class="p">.</span><span class="nx">ExecAll</span><span class="p">(</span><span class="nx">context</span><span class="p">.</span><span class="nx">TODO</span><span class="p">(),</span><span class="w"> </span><span class="nx">aOps</span><span class="p">)</span><span class="w"></span>
<span class="w">	</span><span class="k">if</span><span class="w"> </span><span class="nx">err</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="kc">nil</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">		</span><span class="nx">log</span><span class="p">.</span><span class="nx">Fatal</span><span class="p">(</span><span class="nx">err</span><span class="p">)</span><span class="w"></span>
<span class="w">	</span><span class="p">}</span><span class="w"></span>

<span class="w">	</span><span class="nx">list</span><span class="p">,</span><span class="w"> </span><span class="nx">err</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="nx">client</span><span class="p">.</span><span class="nx">ZScan</span><span class="p">(</span><span class="nx">context</span><span class="p">.</span><span class="nx">TODO</span><span class="p">(),</span><span class="w"> </span><span class="o">&amp;</span><span class="nx">schema</span><span class="p">.</span><span class="nx">ZScanRequest</span><span class="p">{</span><span class="w"></span>
<span class="w">		</span><span class="nx">Set</span><span class="p">:</span><span class="w">     </span><span class="p">[]</span><span class="nb">byte</span><span class="p">(</span><span class="s">`mySet`</span><span class="p">),</span><span class="w"></span>
<span class="w">		</span><span class="nx">SinceTx</span><span class="p">:</span><span class="w"> </span><span class="nx">idx</span><span class="p">.</span><span class="nx">Id</span><span class="p">,</span><span class="w"></span>
<span class="w">		</span><span class="nx">NoWait</span><span class="p">:</span><span class="w">  </span><span class="kc">true</span><span class="p">,</span><span class="w"></span>
<span class="w">	</span><span class="p">})</span><span class="w"></span>
<span class="w">	</span><span class="k">if</span><span class="w"> </span><span class="nx">err</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="kc">nil</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">		</span><span class="nx">log</span><span class="p">.</span><span class="nx">Fatal</span><span class="p">(</span><span class="nx">err</span><span class="p">)</span><span class="w"></span>
<span class="w">	</span><span class="p">}</span><span class="w"></span>
<span class="w">	</span><span class="nx">s</span><span class="p">,</span><span class="w"> </span><span class="nx">_</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="nx">json</span><span class="p">.</span><span class="nx">MarshalIndent</span><span class="p">(</span><span class="nx">list</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;\t&quot;</span><span class="p">)</span><span class="w"></span>
<span class="w">	</span><span class="nx">log</span><span class="p">.</span><span class="nx">Print</span><span class="p">(</span><span class="nb">string</span><span class="p">(</span><span class="nx">s</span><span class="p">))</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
</pre></div>
</div>
<p>:::</p>
<p>::: tab Python</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">immudb</span> <span class="kn">import</span> <span class="n">ImmudbClient</span>
<span class="kn">from</span> <span class="nn">immudb.datatypes</span> <span class="kn">import</span> <span class="n">KeyValue</span><span class="p">,</span> <span class="n">ZAddRequest</span><span class="p">,</span> <span class="n">ReferenceRequest</span>

<span class="n">URL</span> <span class="o">=</span> <span class="s2">&quot;localhost:3322&quot;</span>  <span class="c1"># immudb running on your machine</span>
<span class="n">LOGIN</span> <span class="o">=</span> <span class="s2">&quot;immudb&quot;</span>        <span class="c1"># Default username</span>
<span class="n">PASSWORD</span> <span class="o">=</span> <span class="s2">&quot;immudb&quot;</span>     <span class="c1"># Default password</span>
<span class="n">DB</span> <span class="o">=</span> <span class="sa">b</span><span class="s2">&quot;defaultdb&quot;</span>       <span class="c1"># Default database name (must be in bytes)</span>

<span class="k">def</span> <span class="nf">main</span><span class="p">():</span>
    <span class="n">client</span> <span class="o">=</span> <span class="n">ImmudbClient</span><span class="p">(</span><span class="n">URL</span><span class="p">)</span>
    <span class="n">client</span><span class="o">.</span><span class="n">login</span><span class="p">(</span><span class="n">LOGIN</span><span class="p">,</span> <span class="n">PASSWORD</span><span class="p">,</span> <span class="n">database</span> <span class="o">=</span> <span class="n">DB</span><span class="p">)</span>

    <span class="n">toExecute</span> <span class="o">=</span> <span class="p">[</span>
        <span class="n">KeyValue</span><span class="p">(</span><span class="sa">b</span><span class="s1">&#39;key&#39;</span><span class="p">,</span> <span class="sa">b</span><span class="s1">&#39;value&#39;</span><span class="p">),</span> 
        <span class="n">ZAddRequest</span><span class="p">(</span><span class="sa">b</span><span class="s1">&#39;testscore&#39;</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="sa">b</span><span class="s1">&#39;key&#39;</span><span class="p">),</span>
        <span class="n">KeyValue</span><span class="p">(</span><span class="sa">b</span><span class="s1">&#39;key2&#39;</span><span class="p">,</span> <span class="sa">b</span><span class="s1">&#39;value2&#39;</span><span class="p">),</span> 
        <span class="n">ZAddRequest</span><span class="p">(</span><span class="sa">b</span><span class="s1">&#39;testscore&#39;</span><span class="p">,</span> <span class="mi">150</span><span class="p">,</span> <span class="sa">b</span><span class="s1">&#39;key2&#39;</span><span class="p">),</span>
        <span class="n">ReferenceRequest</span><span class="p">(</span><span class="sa">b</span><span class="s1">&#39;reference1&#39;</span><span class="p">,</span> <span class="sa">b</span><span class="s1">&#39;key&#39;</span><span class="p">)</span>
    <span class="p">]</span>
    <span class="n">info</span> <span class="o">=</span> <span class="n">client</span><span class="o">.</span><span class="n">execAll</span><span class="p">(</span><span class="n">toExecute</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">info</span><span class="o">.</span><span class="n">id</span><span class="p">)</span> <span class="c1"># All in one transaction</span>

    <span class="nb">print</span><span class="p">(</span><span class="n">client</span><span class="o">.</span><span class="n">zScan</span><span class="p">(</span><span class="sa">b</span><span class="s1">&#39;testscore&#39;</span><span class="p">,</span> <span class="sa">b</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="kc">True</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="kc">True</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">200</span><span class="p">))</span> <span class="c1"># Shows these entries</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">client</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="sa">b</span><span class="s1">&#39;reference1&#39;</span><span class="p">))</span>

<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>
    <span class="n">main</span><span class="p">()</span>
</pre></div>
</div>
<p>:::</p>
<p>::: tab Java</p>
<div class="highlight-java notranslate"><div class="highlight"><pre><span></span><span class="kt">byte</span><span class="o">[]</span><span class="w"> </span><span class="n">item1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;execAll_key1&quot;</span><span class="p">.</span><span class="na">getBytes</span><span class="p">(</span><span class="n">StandardCharsets</span><span class="p">.</span><span class="na">UTF_8</span><span class="p">);</span><span class="w"></span>
<span class="kt">byte</span><span class="o">[]</span><span class="w"> </span><span class="n">item2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;execAll_key2&quot;</span><span class="p">.</span><span class="na">getBytes</span><span class="p">(</span><span class="n">StandardCharsets</span><span class="p">.</span><span class="na">UTF_8</span><span class="p">);</span><span class="w"></span>

<span class="c1">// Using execAll just for setting multiple KVs:</span><span class="w"></span>
<span class="n">TxMetadata</span><span class="w"> </span><span class="n">txMd</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">immuClient</span><span class="p">.</span><span class="na">execAll</span><span class="p">(</span><span class="w"></span>
<span class="w">        </span><span class="n">Arrays</span><span class="p">.</span><span class="na">asList</span><span class="p">(</span><span class="w">                 </span><span class="c1">// The kvList.</span><span class="w"></span>
<span class="w">                </span><span class="n">Pair</span><span class="p">.</span><span class="na">of</span><span class="p">(</span><span class="n">item1</span><span class="p">,</span><span class="w"> </span><span class="n">item1</span><span class="p">),</span><span class="w"></span>
<span class="w">                </span><span class="n">Pair</span><span class="p">.</span><span class="na">of</span><span class="p">(</span><span class="n">item2</span><span class="p">,</span><span class="w"> </span><span class="n">item2</span><span class="p">)</span><span class="w"></span>
<span class="w">        </span><span class="p">),</span><span class="w"></span>
<span class="w">        </span><span class="kc">null</span><span class="p">,</span><span class="w">                         </span><span class="c1">// No refList provided.</span><span class="w"></span>
<span class="w">        </span><span class="kc">null</span><span class="w">                          </span><span class="c1">// No zaddList provided.</span><span class="w"></span>
<span class="p">);</span><span class="w"></span>

<span class="n">immuClient</span><span class="p">.</span><span class="na">execAll</span><span class="p">(</span><span class="w"></span>
<span class="w">        </span><span class="kc">null</span><span class="p">,</span><span class="w">                         </span><span class="c1">// No kvList provided.</span><span class="w"></span>
<span class="w">        </span><span class="n">Arrays</span><span class="p">.</span><span class="na">asList</span><span class="p">(</span><span class="w">                </span><span class="c1">// The refList.</span><span class="w"></span>
<span class="w">                </span><span class="n">Pair</span><span class="p">.</span><span class="na">of</span><span class="p">(</span><span class="s">&quot;ref1&quot;</span><span class="p">.</span><span class="na">getBytes</span><span class="p">(</span><span class="n">StandardCharsets</span><span class="p">.</span><span class="na">UTF_8</span><span class="p">),</span><span class="w"> </span><span class="n">item1</span><span class="p">),</span><span class="w"></span>
<span class="w">                </span><span class="n">Pair</span><span class="p">.</span><span class="na">of</span><span class="p">(</span><span class="s">&quot;ref2&quot;</span><span class="p">.</span><span class="na">getBytes</span><span class="p">(</span><span class="n">StandardCharsets</span><span class="p">.</span><span class="na">UTF_8</span><span class="p">),</span><span class="w"> </span><span class="n">item2</span><span class="p">)</span><span class="w"></span>
<span class="w">        </span><span class="p">),</span><span class="w"></span>
<span class="w">        </span><span class="c1">// The zaddList (even if it has one single entry).</span><span class="w"></span>
<span class="w">        </span><span class="n">Collections</span><span class="p">.</span><span class="na">singletonList</span><span class="p">(</span><span class="n">Triple</span><span class="p">.</span><span class="na">of</span><span class="p">(</span><span class="s">&quot;set1&quot;</span><span class="p">,</span><span class="w"> </span><span class="mf">1.0</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;execAll_key1&quot;</span><span class="p">))</span><span class="w"></span>
<span class="p">);</span><span class="w"></span>
</pre></div>
</div>
<p>:::</p>
<p>::: tab Node.js</p>
<div class="highlight-ts notranslate"><div class="highlight"><pre><span></span><span class="k">import</span><span class="w"> </span><span class="nx">ImmudbClient</span><span class="w"> </span><span class="kr">from</span><span class="w"> </span><span class="s1">&#39;immudb-node&#39;</span><span class="w"></span>
<span class="k">import</span><span class="w"> </span><span class="nx">Parameters</span><span class="w"> </span><span class="kr">from</span><span class="w"> </span><span class="s1">&#39;immudb-node/types/parameters&#39;</span><span class="w"></span>

<span class="kd">const</span><span class="w"> </span><span class="nx">IMMUDB_HOST</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;127.0.0.1&#39;</span><span class="w"></span>
<span class="kd">const</span><span class="w"> </span><span class="nx">IMMUDB_PORT</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;3322&#39;</span><span class="w"></span>
<span class="kd">const</span><span class="w"> </span><span class="nx">IMMUDB_USER</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;immudb&#39;</span><span class="w"></span>
<span class="kd">const</span><span class="w"> </span><span class="nx">IMMUDB_PWD</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;immudb&#39;</span><span class="w"></span>

<span class="kd">const</span><span class="w"> </span><span class="nx">cl</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="nx">ImmudbClient</span><span class="p">({</span><span class="w"> </span><span class="nx">host</span><span class="o">:</span><span class="w"> </span><span class="kt">IMMUDB_HOST</span><span class="p">,</span><span class="w"> </span><span class="nx">port</span><span class="o">:</span><span class="w"> </span><span class="kt">IMMUDB_PORT</span><span class="w"> </span><span class="p">});</span><span class="w"></span>

<span class="p">(</span><span class="k">async</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w"> </span><span class="k">await</span><span class="w"> </span><span class="nx">cl</span><span class="p">.</span><span class="nx">login</span><span class="p">({</span><span class="w"> </span><span class="nx">user</span><span class="o">:</span><span class="w"> </span><span class="kt">IMMUDB_USER</span><span class="p">,</span><span class="w"> </span><span class="nx">password</span><span class="o">:</span><span class="w"> </span><span class="kt">IMMUDB_PWD</span><span class="w"> </span><span class="p">})</span><span class="w"></span>

<span class="w"> </span><span class="kd">const</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">id</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">await</span><span class="w"> </span><span class="nx">cl</span><span class="p">.</span><span class="nx">set</span><span class="p">({</span><span class="w"> </span><span class="nx">key</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;persistedKey&#39;</span><span class="p">,</span><span class="w"> </span><span class="nx">value</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;persistedVal&#39;</span><span class="w"> </span><span class="p">})</span><span class="w"></span>

<span class="w"> </span><span class="kd">const</span><span class="w"> </span><span class="nx">setOperation</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">kv</span><span class="o">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">key</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;notPersistedKey&#39;</span><span class="p">,</span><span class="w"> </span><span class="nx">value</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;notPersistedVal&#39;</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="p">}</span><span class="w"></span>
<span class="w"> </span><span class="kd">const</span><span class="w"> </span><span class="nx">zAddOperation</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">  </span><span class="nx">zadd</span><span class="o">:</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">   </span><span class="nx">set</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;mySet&#39;</span><span class="p">,</span><span class="w"></span>
<span class="w">   </span><span class="nx">score</span><span class="o">:</span><span class="w"> </span><span class="kt">0.6</span><span class="p">,</span><span class="w"></span>
<span class="w">   </span><span class="nx">key</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;notPersistedKey&#39;</span><span class="p">,</span><span class="w"></span>
<span class="w">   </span><span class="nx">attx</span><span class="o">:</span><span class="w"> </span><span class="kt">0</span><span class="p">,</span><span class="w"></span>
<span class="w">   </span><span class="nx">boundref</span><span class="o">:</span><span class="w"> </span><span class="kt">true</span><span class="w"></span>
<span class="w">  </span><span class="p">}</span><span class="w"></span>
<span class="w"> </span><span class="p">}</span><span class="w"></span>
<span class="w"> </span><span class="kd">const</span><span class="w"> </span><span class="nx">zAddOperation1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">  </span><span class="nx">zadd</span><span class="o">:</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">   </span><span class="nx">set</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;mySet&#39;</span><span class="p">,</span><span class="w"></span>
<span class="w">   </span><span class="nx">score</span><span class="o">:</span><span class="w"> </span><span class="kt">0.6</span><span class="p">,</span><span class="w"></span>
<span class="w">   </span><span class="nx">key</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;persistedKey&#39;</span><span class="p">,</span><span class="w"></span>
<span class="w">   </span><span class="nx">attx</span><span class="o">:</span><span class="w"> </span><span class="kt">id</span><span class="p">,</span><span class="w"></span>
<span class="w">   </span><span class="nx">boundref</span><span class="o">:</span><span class="w"> </span><span class="kt">true</span><span class="w"></span>
<span class="w">  </span><span class="p">}</span><span class="w"></span>
<span class="w"> </span><span class="p">}</span><span class="w"></span>
<span class="w"> </span><span class="kd">const</span><span class="w"> </span><span class="nx">execAllReq</span><span class="o">:</span><span class="w"> </span><span class="kt">Parameters.ExecAll</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">  </span><span class="nx">operationsList</span><span class="o">:</span><span class="w"> </span><span class="p">[</span><span class="w"></span>
<span class="w">   </span><span class="nx">setOperation</span><span class="p">,</span><span class="w"></span>
<span class="w">   </span><span class="nx">zAddOperation</span><span class="p">,</span><span class="w"></span>
<span class="w">   </span><span class="nx">zAddOperation1</span><span class="p">,</span><span class="w"></span>
<span class="w">  </span><span class="p">]</span><span class="w"></span>
<span class="w"> </span><span class="p">}</span><span class="w"></span>
<span class="w"> </span><span class="kd">const</span><span class="w"> </span><span class="nx">execAllRes</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">await</span><span class="w"> </span><span class="nx">cl</span><span class="p">.</span><span class="nx">execAll</span><span class="p">(</span><span class="nx">execAllReq</span><span class="p">)</span><span class="w"></span>
<span class="w"> </span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;success: execAll&#39;</span><span class="p">,</span><span class="w"> </span><span class="nx">execAllRes</span><span class="p">)</span><span class="w"></span>
<span class="p">})()</span><span class="w"></span>
</pre></div>
</div>
<p>:::</p>
<p>::: tab Others
If you’re using another development language, please refer to the <a class="reference internal" href="immugw.html"><span class="doc std std-doc">immugw</span></a> option.
:::</p>
<p>::::</p>
</section>
<section id="txscan">
<h2>TxScan<a class="headerlink" href="#txscan" title="Permalink to this heading">¶</a></h2>
<p><code class="docutils literal notranslate"><span class="pre">TxScan</span></code> permits iterating over transactions.</p>
<p>The argument of a <code class="docutils literal notranslate"><span class="pre">TxScan</span></code> is an array of the following types:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">InitialTx</span></code>: initial transaction id</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">Limit</span></code>: number of transactions returned</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">Desc</span></code>: order of returned transacations</p></li>
</ul>
<p>:::: tabs</p>
<p>::: tab Go</p>
<div class="highlight-go notranslate"><div class="highlight"><pre><span></span><span class="kn">package</span><span class="w"> </span><span class="nx">main</span><span class="w"></span>

<span class="kn">import</span><span class="w"> </span><span class="p">(</span><span class="w"></span>
<span class="w">	</span><span class="s">&quot;context&quot;</span><span class="w"></span>
<span class="w">	</span><span class="s">&quot;log&quot;</span><span class="w"></span>

<span class="w">	</span><span class="s">&quot;github.com/codenotary/immudb/pkg/api/schema&quot;</span><span class="w"></span>
<span class="w">	</span><span class="nx">immudb</span><span class="w"> </span><span class="s">&quot;github.com/codenotary/immudb/pkg/client&quot;</span><span class="w"></span>
<span class="p">)</span><span class="w"></span>

<span class="kd">func</span><span class="w"> </span><span class="nx">main</span><span class="p">()</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">	</span><span class="nx">opts</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="nx">immudb</span><span class="p">.</span><span class="nx">DefaultOptions</span><span class="p">().</span><span class="nx">WithAddress</span><span class="p">(</span><span class="s">&quot;localhost&quot;</span><span class="p">).</span><span class="nx">WithPort</span><span class="p">(</span><span class="mi">3322</span><span class="p">)</span><span class="w"></span>
<span class="w">	</span><span class="nx">client</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="nx">immudb</span><span class="p">.</span><span class="nx">NewClient</span><span class="p">().</span><span class="nx">WithOptions</span><span class="p">(</span><span class="nx">opts</span><span class="p">)</span><span class="w"></span>
<span class="w">	</span><span class="nx">err</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="nx">client</span><span class="p">.</span><span class="nx">OpenSession</span><span class="p">(</span><span class="nx">context</span><span class="p">.</span><span class="nx">TODO</span><span class="p">(),</span><span class="w"> </span><span class="p">[]</span><span class="nb">byte</span><span class="p">(</span><span class="s">`immudb`</span><span class="p">),</span><span class="w"> </span><span class="p">[]</span><span class="nb">byte</span><span class="p">(</span><span class="s">`immudb`</span><span class="p">),</span><span class="w"> </span><span class="s">&quot;defaultdb&quot;</span><span class="p">)</span><span class="w"></span>
<span class="w">	</span><span class="k">if</span><span class="w"> </span><span class="nx">err</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="kc">nil</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">		</span><span class="nx">log</span><span class="p">.</span><span class="nx">Fatal</span><span class="p">(</span><span class="nx">err</span><span class="p">)</span><span class="w"></span>
<span class="w">	</span><span class="p">}</span><span class="w"></span>

<span class="w">	</span><span class="k">defer</span><span class="w"> </span><span class="nx">client</span><span class="p">.</span><span class="nx">CloseSession</span><span class="p">(</span><span class="nx">context</span><span class="p">.</span><span class="nx">TODO</span><span class="p">())</span><span class="w"></span>

<span class="w">	</span><span class="nx">tx</span><span class="p">,</span><span class="w"> </span><span class="nx">err</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="nx">client</span><span class="p">.</span><span class="nx">Set</span><span class="p">(</span><span class="nx">context</span><span class="p">.</span><span class="nx">TODO</span><span class="p">(),</span><span class="w"> </span><span class="p">[]</span><span class="nb">byte</span><span class="p">(</span><span class="s">&quot;key1&quot;</span><span class="p">),</span><span class="w"> </span><span class="p">[]</span><span class="nb">byte</span><span class="p">(</span><span class="s">&quot;val1&quot;</span><span class="p">))</span><span class="w"></span>
<span class="w">	</span><span class="k">if</span><span class="w"> </span><span class="nx">err</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="kc">nil</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">		</span><span class="nx">log</span><span class="p">.</span><span class="nx">Fatal</span><span class="p">(</span><span class="nx">err</span><span class="p">)</span><span class="w"></span>
<span class="w">	</span><span class="p">}</span><span class="w"></span>
<span class="w">	</span><span class="nx">_</span><span class="p">,</span><span class="w"> </span><span class="nx">err</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="nx">client</span><span class="p">.</span><span class="nx">Set</span><span class="p">(</span><span class="nx">context</span><span class="p">.</span><span class="nx">TODO</span><span class="p">(),</span><span class="w"> </span><span class="p">[]</span><span class="nb">byte</span><span class="p">(</span><span class="s">&quot;key2&quot;</span><span class="p">),</span><span class="w"> </span><span class="p">[]</span><span class="nb">byte</span><span class="p">(</span><span class="s">&quot;val2&quot;</span><span class="p">))</span><span class="w"></span>
<span class="w">	</span><span class="k">if</span><span class="w"> </span><span class="nx">err</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="kc">nil</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">		</span><span class="nx">log</span><span class="p">.</span><span class="nx">Fatal</span><span class="p">(</span><span class="nx">err</span><span class="p">)</span><span class="w"></span>
<span class="w">	</span><span class="p">}</span><span class="w"></span>
<span class="w">	</span><span class="nx">_</span><span class="p">,</span><span class="w"> </span><span class="nx">err</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="nx">client</span><span class="p">.</span><span class="nx">Set</span><span class="p">(</span><span class="nx">context</span><span class="p">.</span><span class="nx">TODO</span><span class="p">(),</span><span class="w"> </span><span class="p">[]</span><span class="nb">byte</span><span class="p">(</span><span class="s">&quot;key3&quot;</span><span class="p">),</span><span class="w"> </span><span class="p">[]</span><span class="nb">byte</span><span class="p">(</span><span class="s">&quot;val3&quot;</span><span class="p">))</span><span class="w"></span>
<span class="w">	</span><span class="k">if</span><span class="w"> </span><span class="nx">err</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="kc">nil</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">		</span><span class="nx">log</span><span class="p">.</span><span class="nx">Fatal</span><span class="p">(</span><span class="nx">err</span><span class="p">)</span><span class="w"></span>
<span class="w">	</span><span class="p">}</span><span class="w"></span>

<span class="w">	</span><span class="nx">txs</span><span class="p">,</span><span class="w"> </span><span class="nx">err</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="nx">client</span><span class="p">.</span><span class="nx">TxScan</span><span class="p">(</span><span class="nx">context</span><span class="p">.</span><span class="nx">TODO</span><span class="p">(),</span><span class="w"> </span><span class="o">&amp;</span><span class="nx">schema</span><span class="p">.</span><span class="nx">TxScanRequest</span><span class="p">{</span><span class="w"></span>
<span class="w">		</span><span class="nx">InitialTx</span><span class="p">:</span><span class="w"> </span><span class="nx">tx</span><span class="p">.</span><span class="nx">Id</span><span class="p">,</span><span class="w"></span>
<span class="w">		</span><span class="nx">Limit</span><span class="p">:</span><span class="w">     </span><span class="mi">3</span><span class="p">,</span><span class="w"></span>
<span class="w">		</span><span class="nx">Desc</span><span class="p">:</span><span class="w">      </span><span class="kc">true</span><span class="p">,</span><span class="w"></span>
<span class="w">	</span><span class="p">})</span><span class="w"></span>
<span class="w">	</span><span class="k">if</span><span class="w"> </span><span class="nx">err</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="kc">nil</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">		</span><span class="nx">log</span><span class="p">.</span><span class="nx">Fatal</span><span class="p">(</span><span class="nx">err</span><span class="p">)</span><span class="w"></span>
<span class="w">	</span><span class="p">}</span><span class="w"></span>

<span class="w">	</span><span class="c1">// Then it&#39;s possible to retrieve entries of every transactions:</span><span class="w"></span>
<span class="w">	</span><span class="k">for</span><span class="w"> </span><span class="nx">_</span><span class="p">,</span><span class="w"> </span><span class="nx">tx</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="k">range</span><span class="w"> </span><span class="nx">txs</span><span class="p">.</span><span class="nx">GetTxs</span><span class="p">()</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">		</span><span class="k">for</span><span class="w"> </span><span class="nx">_</span><span class="p">,</span><span class="w"> </span><span class="nx">entry</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="k">range</span><span class="w"> </span><span class="nx">tx</span><span class="p">.</span><span class="nx">Entries</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">			</span><span class="nx">item</span><span class="p">,</span><span class="w"> </span><span class="nx">err</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="nx">client</span><span class="p">.</span><span class="nx">GetAt</span><span class="p">(</span><span class="nx">context</span><span class="p">.</span><span class="nx">TODO</span><span class="p">(),</span><span class="w"> </span><span class="nx">entry</span><span class="p">.</span><span class="nx">Key</span><span class="p">[</span><span class="mi">1</span><span class="p">:],</span><span class="w"> </span><span class="nx">tx</span><span class="p">.</span><span class="nx">Header</span><span class="p">.</span><span class="nx">Id</span><span class="p">)</span><span class="w"></span>
<span class="w">			</span><span class="k">if</span><span class="w"> </span><span class="nx">err</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="kc">nil</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">				</span><span class="nx">item</span><span class="p">,</span><span class="w"> </span><span class="nx">err</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="nx">client</span><span class="p">.</span><span class="nx">GetAt</span><span class="p">(</span><span class="nx">context</span><span class="p">.</span><span class="nx">TODO</span><span class="p">(),</span><span class="w"> </span><span class="nx">entry</span><span class="p">.</span><span class="nx">Key</span><span class="p">,</span><span class="w"> </span><span class="nx">tx</span><span class="p">.</span><span class="nx">Header</span><span class="p">.</span><span class="nx">Id</span><span class="p">)</span><span class="w"></span>
<span class="w">				</span><span class="k">if</span><span class="w"> </span><span class="nx">err</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="kc">nil</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">					</span><span class="nx">log</span><span class="p">.</span><span class="nx">Fatal</span><span class="p">(</span><span class="nx">err</span><span class="p">)</span><span class="w"></span>
<span class="w">				</span><span class="p">}</span><span class="w"></span>
<span class="w">			</span><span class="p">}</span><span class="w"></span>
<span class="w">			</span><span class="nx">log</span><span class="p">.</span><span class="nx">Printf</span><span class="p">(</span><span class="s">&quot;retrieved key %s and val %s\n&quot;</span><span class="p">,</span><span class="w"> </span><span class="nx">item</span><span class="p">.</span><span class="nx">Key</span><span class="p">,</span><span class="w"> </span><span class="nx">item</span><span class="p">.</span><span class="nx">Value</span><span class="p">)</span><span class="w"></span>
<span class="w">		</span><span class="p">}</span><span class="w"></span>
<span class="w">	</span><span class="p">}</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
</pre></div>
</div>
<blockquote>
<div><p>Remember to strip the first byte in the key (key prefix).
Remember that a transaction could contain sorted sets keys that should not be skipped.
:::</p>
</div></blockquote>
<p>::: tab Python
This feature is not yet supported or not documented.
Do you want to make a feature request or help out? Open an issue on <a class="reference external" href="https://github.com/codenotary/immudb-py/issues/new">Python sdk github project</a>
:::</p>
<p>::: tab Java</p>
<div class="highlight-java notranslate"><div class="highlight"><pre><span></span><span class="n">String</span><span class="w"> </span><span class="n">key</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;txtest-t2&quot;</span><span class="p">;</span><span class="w"></span>
<span class="kt">byte</span><span class="o">[]</span><span class="w"> </span><span class="n">val1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;immuRocks!&quot;</span><span class="p">.</span><span class="na">getBytes</span><span class="p">(</span><span class="n">StandardCharsets</span><span class="p">.</span><span class="na">UTF_8</span><span class="p">);</span><span class="w"></span>
<span class="kt">byte</span><span class="o">[]</span><span class="w"> </span><span class="n">val2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;immuRocks! Again!&quot;</span><span class="p">.</span><span class="na">getBytes</span><span class="p">(</span><span class="n">StandardCharsets</span><span class="p">.</span><span class="na">UTF_8</span><span class="p">);</span><span class="w"></span>

<span class="kt">long</span><span class="w"> </span><span class="n">initialTxId</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span><span class="w"></span>
<span class="k">try</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="n">TxMetadata</span><span class="w"> </span><span class="n">txMd</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">immuClient</span><span class="p">.</span><span class="na">set</span><span class="p">(</span><span class="n">key</span><span class="p">,</span><span class="w"> </span><span class="n">val1</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">initialTxId</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">txMd</span><span class="p">.</span><span class="na">id</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">txMd</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">immuClient</span><span class="p">.</span><span class="na">set</span><span class="p">(</span><span class="n">key</span><span class="p">,</span><span class="w"> </span><span class="n">val2</span><span class="p">);</span><span class="w"></span>
<span class="p">}</span><span class="w"> </span><span class="k">catch</span><span class="w"> </span><span class="p">(</span><span class="n">CorruptedDataException</span><span class="w"> </span><span class="n">e</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="n">Assert</span><span class="p">.</span><span class="na">fail</span><span class="p">(</span><span class="s">&quot;Failed at set.&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">e</span><span class="p">);</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
<span class="w">            </span><span class="c1">// This is a .txScan(initialTxId, limit, desc)</span><span class="w"></span>
<span class="n">List</span><span class="o">&lt;</span><span class="n">Tx</span><span class="o">&gt;</span><span class="w"> </span><span class="n">txs</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">immuClient</span><span class="p">.</span><span class="na">txScan</span><span class="p">(</span><span class="n">initialTxId</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="kc">false</span><span class="p">);</span><span class="w"></span>
<span class="c1">// We expect one Tx entry in this list.</span><span class="w"></span>

<span class="n">txs</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">immuClient</span><span class="p">.</span><span class="na">txScan</span><span class="p">(</span><span class="n">initialTxId</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="kc">false</span><span class="p">);</span><span class="w"></span>
<span class="c1">// We expect two Tx entries in this list.</span><span class="w"></span>
</pre></div>
</div>
<p>:::</p>
<p>::: tab Node.js</p>
<div class="highlight-ts notranslate"><div class="highlight"><pre><span></span><span class="k">import</span><span class="w"> </span><span class="nx">ImmudbClient</span><span class="w"> </span><span class="kr">from</span><span class="w"> </span><span class="s1">&#39;immudb-node&#39;</span><span class="w"></span>
<span class="k">import</span><span class="w"> </span><span class="nx">Parameters</span><span class="w"> </span><span class="kr">from</span><span class="w"> </span><span class="s1">&#39;immudb-node/types/parameters&#39;</span><span class="w"></span>

<span class="kd">const</span><span class="w"> </span><span class="nx">IMMUDB_HOST</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;127.0.0.1&#39;</span><span class="w"></span>
<span class="kd">const</span><span class="w"> </span><span class="nx">IMMUDB_PORT</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;3322&#39;</span><span class="w"></span>
<span class="kd">const</span><span class="w"> </span><span class="nx">IMMUDB_USER</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;immudb&#39;</span><span class="w"></span>
<span class="kd">const</span><span class="w"> </span><span class="nx">IMMUDB_PWD</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;immudb&#39;</span><span class="w"></span>

<span class="kd">const</span><span class="w"> </span><span class="nx">cl</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="nx">ImmudbClient</span><span class="p">({</span><span class="w"> </span><span class="nx">host</span><span class="o">:</span><span class="w"> </span><span class="kt">IMMUDB_HOST</span><span class="p">,</span><span class="w"> </span><span class="nx">port</span><span class="o">:</span><span class="w"> </span><span class="kt">IMMUDB_PORT</span><span class="w"> </span><span class="p">});</span><span class="w"></span>

<span class="p">(</span><span class="k">async</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w"> </span><span class="k">await</span><span class="w"> </span><span class="nx">cl</span><span class="p">.</span><span class="nx">login</span><span class="p">({</span><span class="w"> </span><span class="nx">user</span><span class="o">:</span><span class="w"> </span><span class="kt">IMMUDB_USER</span><span class="p">,</span><span class="w"> </span><span class="nx">password</span><span class="o">:</span><span class="w"> </span><span class="kt">IMMUDB_PWD</span><span class="w"> </span><span class="p">})</span><span class="w"></span>

<span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kd">let</span><span class="w"> </span><span class="nx">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0</span><span class="p">;</span><span class="w"> </span><span class="nx">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mf">3</span><span class="p">;</span><span class="w"> </span><span class="nx">i</span><span class="o">++</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">  </span><span class="k">await</span><span class="w"> </span><span class="nx">cl</span><span class="p">.</span><span class="nx">set</span><span class="p">({</span><span class="w"> </span><span class="nx">key</span><span class="o">:</span><span class="w"> </span><span class="sb">`key</span><span class="si">${</span><span class="nx">i</span><span class="si">}</span><span class="sb">`</span><span class="p">,</span><span class="w"> </span><span class="nx">value</span><span class="o">:</span><span class="w"> </span><span class="sb">`val</span><span class="si">${</span><span class="nx">i</span><span class="si">}</span><span class="sb">`</span><span class="w"> </span><span class="p">})</span><span class="w"></span>
<span class="w"> </span><span class="p">}</span><span class="w"></span>

<span class="w"> </span><span class="kd">const</span><span class="w"> </span><span class="nx">txScanReq</span><span class="o">:</span><span class="w"> </span><span class="kt">Parameters.TxScan</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">  </span><span class="nx">initialtx</span><span class="o">:</span><span class="w"> </span><span class="kt">2</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="nx">limit</span><span class="o">:</span><span class="w"> </span><span class="kt">3</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="nx">desc</span><span class="o">:</span><span class="w"> </span><span class="kt">false</span><span class="w"></span>
<span class="w"> </span><span class="p">}</span><span class="w"></span>
<span class="w"> </span><span class="kd">const</span><span class="w"> </span><span class="nx">txScanRes</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">await</span><span class="w"> </span><span class="nx">cl</span><span class="p">.</span><span class="nx">txScan</span><span class="p">(</span><span class="nx">txScanReq</span><span class="p">)</span><span class="w"></span>
<span class="w"> </span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;success: txScan&#39;</span><span class="p">,</span><span class="w"> </span><span class="nx">txScanRes</span><span class="p">)</span><span class="w"></span>
<span class="p">})()</span><span class="w"></span>
</pre></div>
</div>
<p>:::</p>
<p>::: tab Others
If you’re using another development language, please refer to the <a class="reference internal" href="immugw.html"><span class="doc std std-doc">immugw</span></a> option.
:::</p>
<p>::::</p>
</section>
<section id="filter-transactions">
<h2>Filter Transactions<a class="headerlink" href="#filter-transactions" title="Permalink to this heading">¶</a></h2>
<p>The transaction entries are generated by writing key-value pairs, referencing keys, associating scores to key-value pairs (with <code class="docutils literal notranslate"><span class="pre">ZAdd</span></code> operation), and by mapping SQL data model into key-value model.</p>
<p>With <code class="docutils literal notranslate"><span class="pre">TxScan</span></code> or <code class="docutils literal notranslate"><span class="pre">TxByIDWithSpec</span></code> operations it’s possible to retrieve entries of certain types, either retrieving the digest of the value assigned to the key (<code class="docutils literal notranslate"><span class="pre">EntryTypeAction_ONLY_DIGEST</span></code>), the raw value (<code class="docutils literal notranslate"><span class="pre">EntryTypeAction_RAW_VALUE</span></code>) or the structured value (<code class="docutils literal notranslate"><span class="pre">EntryTypeAction_RESOLVE</span></code>).</p>
<p>:::: tabs</p>
<p>::: tab Go</p>
<div class="highlight-go notranslate"><div class="highlight"><pre><span></span><span class="kn">package</span><span class="w"> </span><span class="nx">main</span><span class="w"></span>

<span class="kn">import</span><span class="w"> </span><span class="p">(</span><span class="w"></span>
<span class="w">	</span><span class="s">&quot;context&quot;</span><span class="w"></span>
<span class="w">	</span><span class="s">&quot;log&quot;</span><span class="w"></span>

<span class="w">	</span><span class="s">&quot;github.com/codenotary/immudb/pkg/api/schema&quot;</span><span class="w"></span>
<span class="w">	</span><span class="nx">immudb</span><span class="w"> </span><span class="s">&quot;github.com/codenotary/immudb/pkg/client&quot;</span><span class="w"></span>
<span class="p">)</span><span class="w"></span>

<span class="kd">func</span><span class="w"> </span><span class="nx">main</span><span class="p">()</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">	</span><span class="nx">opts</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="nx">immudb</span><span class="p">.</span><span class="nx">DefaultOptions</span><span class="p">().</span><span class="nx">WithAddress</span><span class="p">(</span><span class="s">&quot;localhost&quot;</span><span class="p">).</span><span class="nx">WithPort</span><span class="p">(</span><span class="mi">3322</span><span class="p">)</span><span class="w"></span>
<span class="w">	</span><span class="nx">client</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="nx">immudb</span><span class="p">.</span><span class="nx">NewClient</span><span class="p">().</span><span class="nx">WithOptions</span><span class="p">(</span><span class="nx">opts</span><span class="p">)</span><span class="w"></span>
<span class="w">	</span><span class="nx">err</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="nx">client</span><span class="p">.</span><span class="nx">OpenSession</span><span class="p">(</span><span class="nx">context</span><span class="p">.</span><span class="nx">TODO</span><span class="p">(),</span><span class="w"> </span><span class="p">[]</span><span class="nb">byte</span><span class="p">(</span><span class="s">`immudb`</span><span class="p">),</span><span class="w"> </span><span class="p">[]</span><span class="nb">byte</span><span class="p">(</span><span class="s">`immudb`</span><span class="p">),</span><span class="w"> </span><span class="s">&quot;defaultdb&quot;</span><span class="p">)</span><span class="w"></span>
<span class="w">	</span><span class="k">if</span><span class="w"> </span><span class="nx">err</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="kc">nil</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">		</span><span class="nx">log</span><span class="p">.</span><span class="nx">Fatal</span><span class="p">(</span><span class="nx">err</span><span class="p">)</span><span class="w"></span>
<span class="w">	</span><span class="p">}</span><span class="w"></span>

<span class="w">	</span><span class="k">defer</span><span class="w"> </span><span class="nx">client</span><span class="p">.</span><span class="nx">CloseSession</span><span class="p">(</span><span class="nx">context</span><span class="p">.</span><span class="nx">TODO</span><span class="p">())</span><span class="w"></span>

<span class="w">	</span><span class="nx">hdr</span><span class="p">,</span><span class="w"> </span><span class="nx">err</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="nx">client</span><span class="p">.</span><span class="nx">ExecAll</span><span class="p">(</span><span class="nx">context</span><span class="p">.</span><span class="nx">TODO</span><span class="p">(),</span><span class="w"> </span><span class="o">&amp;</span><span class="nx">schema</span><span class="p">.</span><span class="nx">ExecAllRequest</span><span class="p">{</span><span class="w"></span>
<span class="w">		</span><span class="nx">Operations</span><span class="p">:</span><span class="w"> </span><span class="p">[]</span><span class="o">*</span><span class="nx">schema</span><span class="p">.</span><span class="nx">Op</span><span class="p">{</span><span class="w"></span>
<span class="w">			</span><span class="p">{</span><span class="w"></span>
<span class="w">				</span><span class="nx">Operation</span><span class="p">:</span><span class="w"> </span><span class="o">&amp;</span><span class="nx">schema</span><span class="p">.</span><span class="nx">Op_Kv</span><span class="p">{</span><span class="w"></span>
<span class="w">					</span><span class="nx">Kv</span><span class="p">:</span><span class="w"> </span><span class="o">&amp;</span><span class="nx">schema</span><span class="p">.</span><span class="nx">KeyValue</span><span class="p">{</span><span class="w"></span>
<span class="w">						</span><span class="nx">Key</span><span class="p">:</span><span class="w">   </span><span class="p">[]</span><span class="nb">byte</span><span class="p">(</span><span class="s">&quot;key1&quot;</span><span class="p">),</span><span class="w"></span>
<span class="w">						</span><span class="nx">Value</span><span class="p">:</span><span class="w"> </span><span class="p">[]</span><span class="nb">byte</span><span class="p">(</span><span class="s">&quot;value1&quot;</span><span class="p">),</span><span class="w"></span>
<span class="w">					</span><span class="p">},</span><span class="w"></span>
<span class="w">				</span><span class="p">},</span><span class="w"></span>
<span class="w">			</span><span class="p">},</span><span class="w"></span>
<span class="w">			</span><span class="p">{</span><span class="w"></span>
<span class="w">				</span><span class="nx">Operation</span><span class="p">:</span><span class="w"> </span><span class="o">&amp;</span><span class="nx">schema</span><span class="p">.</span><span class="nx">Op_Ref</span><span class="p">{</span><span class="w"></span>
<span class="w">					</span><span class="nx">Ref</span><span class="p">:</span><span class="w"> </span><span class="o">&amp;</span><span class="nx">schema</span><span class="p">.</span><span class="nx">ReferenceRequest</span><span class="p">{</span><span class="w"></span>
<span class="w">						</span><span class="nx">Key</span><span class="p">:</span><span class="w">           </span><span class="p">[]</span><span class="nb">byte</span><span class="p">(</span><span class="s">&quot;ref1&quot;</span><span class="p">),</span><span class="w"></span>
<span class="w">						</span><span class="nx">ReferencedKey</span><span class="p">:</span><span class="w"> </span><span class="p">[]</span><span class="nb">byte</span><span class="p">(</span><span class="s">&quot;key1&quot;</span><span class="p">),</span><span class="w"></span>
<span class="w">					</span><span class="p">},</span><span class="w"></span>
<span class="w">				</span><span class="p">},</span><span class="w"></span>
<span class="w">			</span><span class="p">},</span><span class="w"></span>
<span class="w">			</span><span class="p">{</span><span class="w"></span>
<span class="w">				</span><span class="nx">Operation</span><span class="p">:</span><span class="w"> </span><span class="o">&amp;</span><span class="nx">schema</span><span class="p">.</span><span class="nx">Op_ZAdd</span><span class="p">{</span><span class="w"></span>
<span class="w">					</span><span class="nx">ZAdd</span><span class="p">:</span><span class="w"> </span><span class="o">&amp;</span><span class="nx">schema</span><span class="p">.</span><span class="nx">ZAddRequest</span><span class="p">{</span><span class="w"></span>
<span class="w">						</span><span class="nx">Set</span><span class="p">:</span><span class="w">   </span><span class="p">[]</span><span class="nb">byte</span><span class="p">(</span><span class="s">&quot;set1&quot;</span><span class="p">),</span><span class="w"></span>
<span class="w">						</span><span class="nx">Score</span><span class="p">:</span><span class="w"> </span><span class="mi">10</span><span class="p">,</span><span class="w"></span>
<span class="w">						</span><span class="nx">Key</span><span class="p">:</span><span class="w">   </span><span class="p">[]</span><span class="nb">byte</span><span class="p">(</span><span class="s">&quot;key1&quot;</span><span class="p">),</span><span class="w"></span>
<span class="w">					</span><span class="p">},</span><span class="w"></span>
<span class="w">				</span><span class="p">},</span><span class="w"></span>
<span class="w">			</span><span class="p">},</span><span class="w"></span>
<span class="w">		</span><span class="p">},</span><span class="w"></span>
<span class="w">	</span><span class="p">})</span><span class="w"></span>

<span class="w">	</span><span class="c1">// fetch kv and sorted-set entries as structured values while skipping sql-related entries</span><span class="w"></span>
<span class="w">	</span><span class="nx">tx</span><span class="p">,</span><span class="w"> </span><span class="nx">err</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="nx">client</span><span class="p">.</span><span class="nx">TxByIDWithSpec</span><span class="p">(</span><span class="nx">context</span><span class="p">.</span><span class="nx">TODO</span><span class="p">(),</span><span class="w"> </span><span class="o">&amp;</span><span class="nx">schema</span><span class="p">.</span><span class="nx">TxRequest</span><span class="p">{</span><span class="w"></span>
<span class="w">		</span><span class="nx">Tx</span><span class="p">:</span><span class="w"> </span><span class="nx">hdr</span><span class="p">.</span><span class="nx">Id</span><span class="p">,</span><span class="w"></span>
<span class="w">		</span><span class="nx">EntriesSpec</span><span class="p">:</span><span class="w"> </span><span class="o">&amp;</span><span class="nx">schema</span><span class="p">.</span><span class="nx">EntriesSpec</span><span class="p">{</span><span class="w"></span>
<span class="w">			</span><span class="nx">KvEntriesSpec</span><span class="p">:</span><span class="w"> </span><span class="o">&amp;</span><span class="nx">schema</span><span class="p">.</span><span class="nx">EntryTypeSpec</span><span class="p">{</span><span class="w"></span>
<span class="w">				</span><span class="nx">Action</span><span class="p">:</span><span class="w"> </span><span class="nx">schema</span><span class="p">.</span><span class="nx">EntryTypeAction_RESOLVE</span><span class="p">,</span><span class="w"></span>
<span class="w">			</span><span class="p">},</span><span class="w"></span>
<span class="w">			</span><span class="nx">ZEntriesSpec</span><span class="p">:</span><span class="w"> </span><span class="o">&amp;</span><span class="nx">schema</span><span class="p">.</span><span class="nx">EntryTypeSpec</span><span class="p">{</span><span class="w"></span>
<span class="w">				</span><span class="nx">Action</span><span class="p">:</span><span class="w"> </span><span class="nx">schema</span><span class="p">.</span><span class="nx">EntryTypeAction_RESOLVE</span><span class="p">,</span><span class="w"></span>
<span class="w">			</span><span class="p">},</span><span class="w"></span>
<span class="w">			</span><span class="c1">// explicit exclusion is optional</span><span class="w"></span>
<span class="w">			</span><span class="nx">SqlEntriesSpec</span><span class="p">:</span><span class="w"> </span><span class="o">&amp;</span><span class="nx">schema</span><span class="p">.</span><span class="nx">EntryTypeSpec</span><span class="p">{</span><span class="w"></span>
<span class="w">				</span><span class="c1">// resolution of sql entries is not supported</span><span class="w"></span>
<span class="w">				</span><span class="nx">Action</span><span class="p">:</span><span class="w"> </span><span class="nx">schema</span><span class="p">.</span><span class="nx">EntryTypeAction_EXCLUDE</span><span class="p">,</span><span class="w"></span>
<span class="w">			</span><span class="p">},</span><span class="w"></span>
<span class="w">		</span><span class="p">},</span><span class="w"></span>
<span class="w">	</span><span class="p">})</span><span class="w"></span>
<span class="w">	</span><span class="k">if</span><span class="w"> </span><span class="nx">err</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="kc">nil</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">		</span><span class="nx">log</span><span class="p">.</span><span class="nx">Fatal</span><span class="p">(</span><span class="nx">err</span><span class="p">)</span><span class="w"></span>
<span class="w">	</span><span class="p">}</span><span class="w"></span>

<span class="w">	</span><span class="k">for</span><span class="w"> </span><span class="nx">_</span><span class="p">,</span><span class="w"> </span><span class="nx">entry</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="k">range</span><span class="w"> </span><span class="nx">tx</span><span class="p">.</span><span class="nx">KvEntries</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">		</span><span class="nx">log</span><span class="p">.</span><span class="nx">Printf</span><span class="p">(</span><span class="s">&quot;retrieved key %s and val %s&quot;</span><span class="p">,</span><span class="w"> </span><span class="nx">entry</span><span class="p">.</span><span class="nx">Key</span><span class="p">,</span><span class="w"> </span><span class="nx">entry</span><span class="p">.</span><span class="nx">Value</span><span class="p">)</span><span class="w"></span>
<span class="w">	</span><span class="p">}</span><span class="w"></span>

<span class="w">	</span><span class="k">for</span><span class="w"> </span><span class="nx">_</span><span class="p">,</span><span class="w"> </span><span class="nx">entry</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="k">range</span><span class="w"> </span><span class="nx">tx</span><span class="p">.</span><span class="nx">ZEntries</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">		</span><span class="nx">log</span><span class="p">.</span><span class="nx">Printf</span><span class="p">(</span><span class="s">&quot;retrieved set %s key %s and score %v&quot;</span><span class="p">,</span><span class="w"> </span><span class="nx">entry</span><span class="p">.</span><span class="nx">Set</span><span class="p">,</span><span class="w"> </span><span class="nx">entry</span><span class="p">.</span><span class="nx">Key</span><span class="p">,</span><span class="w"> </span><span class="nx">entry</span><span class="p">.</span><span class="nx">Score</span><span class="p">)</span><span class="w"></span>
<span class="w">	</span><span class="p">}</span><span class="w"></span>

<span class="w">	</span><span class="c1">// scan over unresolved entries</span><span class="w"></span>
<span class="w">	</span><span class="c1">// either EntryTypeAction_ONLY_DIGEST or EntryTypeAction_RAW_VALUE options</span><span class="w"></span>
<span class="w">	</span><span class="k">for</span><span class="w"> </span><span class="nx">_</span><span class="p">,</span><span class="w"> </span><span class="nx">entry</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="k">range</span><span class="w"> </span><span class="nx">tx</span><span class="p">.</span><span class="nx">Entries</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">		</span><span class="nx">log</span><span class="p">.</span><span class="nx">Printf</span><span class="p">(</span><span class="s">&quot;retrieved key %s and digest %v&quot;</span><span class="p">,</span><span class="w"> </span><span class="nx">entry</span><span class="p">.</span><span class="nx">Key</span><span class="p">,</span><span class="w"> </span><span class="nx">entry</span><span class="p">.</span><span class="nx">HValue</span><span class="p">)</span><span class="w"></span>
<span class="w">	</span><span class="p">}</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
</pre></div>
</div>
<p>:::</p>
<p>::: tab Python
This feature is not yet supported or not documented.
Do you want to make a feature request or help out? Open an issue on <a class="reference external" href="https://github.com/codenotary/immudb-py/issues/new">Python sdk github project</a>
:::</p>
<p>::: tab Java
This feature is not yet supported or not documented.
Do you want to make a feature request or help out? Open an issue on <a class="reference external" href="https://github.com/codenotary/immudb4j/issues/new">Java sdk github project</a>
:::</p>
<p>::: tab Node.js
This feature is not yet supported or not documented.
Do you want to make a feature request or help out? Open an issue on <a class="reference external" href="https://github.com/codenotary/immudb-node/issues/new">Node.js sdk github project</a>
:::</p>
<p>::: tab Others
If you’re using another development language, please refer to the <a class="reference internal" href="immugw.html"><span class="doc std std-doc">immugw</span></a> option.
:::</p>
<p>::::</p>
</section>
</section>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="../index.html">Immudb</a></h1>








<h3>Navigation</h3>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../index.html">Documentation overview</a><ul>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>document.getElementById('searchbox').style.display = "block"</script>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2022, Codenotary.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 5.0.2</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.12</a>
      
      |
      <a href="../_sources/develop/transactions.md.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>