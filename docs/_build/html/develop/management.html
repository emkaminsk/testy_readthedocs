
<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

    <title>Management operations &#8212; Immudb 1.3.0 documentation</title>
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/alabaster.css" />
    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../_static/doctools.js"></script>
    <link rel="author" title="About these documents" href="../about.html" />
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
   
  <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <section id="management-operations">
<h1>Management operations<a class="headerlink" href="#management-operations" title="Permalink to this heading">¶</a></h1>
<section id="user-management">
<h2>User management<a class="headerlink" href="#user-management" title="Permalink to this heading">¶</a></h2>
<p>User management is exposed with following methods:</p>
<ul class="simple">
<li><p>CreateUser</p></li>
<li><p>ChangePermission</p></li>
<li><p>ChangePassword</p></li>
</ul>
<p>Password must have between 8 and 32 letters, digits and special characters of which at least 1 uppercase letter, 1 digit and 1 special character.</p>
<p>Admin permissions are:</p>
<ul class="simple">
<li><p>PermissionSysAdmin = 255</p></li>
<li><p>PermissionAdmin = 254</p></li>
</ul>
<p>Non-admin permissions are:</p>
<ul class="simple">
<li><p>PermissionNone = 0</p></li>
<li><p>PermissionR = 1</p></li>
<li><p>PermissionRW = 2</p></li>
</ul>
<p>:::: tabs</p>
<p>::: tab Go</p>
<div class="highlight-go notranslate"><div class="highlight"><pre><span></span><span class="nx">client</span><span class="p">,</span><span class="w"> </span><span class="nx">err</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="nx">immudb</span><span class="p">.</span><span class="nx">NewClient</span><span class="p">()</span><span class="w"></span>
<span class="k">if</span><span class="w"> </span><span class="nx">err</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="kc">nil</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="nx">log</span><span class="p">.</span><span class="nx">Fatal</span><span class="p">(</span><span class="nx">err</span><span class="p">)</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="nx">ctx</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="nx">context</span><span class="p">.</span><span class="nx">Background</span><span class="p">()</span><span class="w"></span>

<span class="nx">err</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="nx">client</span><span class="p">.</span><span class="nx">OpenSession</span><span class="p">(</span><span class="nx">ctx</span><span class="p">,</span><span class="w"> </span><span class="p">[]</span><span class="nb">byte</span><span class="p">(</span><span class="s">`immudb`</span><span class="p">),</span><span class="w"> </span><span class="p">[]</span><span class="nb">byte</span><span class="p">(</span><span class="s">`immudb`</span><span class="p">),</span><span class="w"> </span><span class="s">&quot;defaultdb&quot;</span><span class="p">)</span><span class="w"></span>
<span class="k">if</span><span class="w"> </span><span class="nx">err</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="kc">nil</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="nx">log</span><span class="p">.</span><span class="nx">Fatal</span><span class="p">(</span><span class="nx">err</span><span class="p">)</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="k">defer</span><span class="w"> </span><span class="nx">client</span><span class="p">.</span><span class="nx">CloseSession</span><span class="p">(</span><span class="nx">ctx</span><span class="p">)</span><span class="w"></span>

<span class="nx">err</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="nx">client</span><span class="p">.</span><span class="nx">CreateUser</span><span class="p">(</span><span class="nx">ctx</span><span class="p">,</span><span class="w"> </span><span class="p">[]</span><span class="nb">byte</span><span class="p">(</span><span class="s">`myNewUser1`</span><span class="p">),</span><span class="w"> </span><span class="p">[]</span><span class="nb">byte</span><span class="p">(</span><span class="s">`myS3cretPassword!`</span><span class="p">),</span><span class="w"> </span><span class="nx">auth</span><span class="p">.</span><span class="nx">PermissionR</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;defaultdb&quot;</span><span class="p">)</span><span class="w"></span>
<span class="k">if</span><span class="w"> </span><span class="nx">err</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="kc">nil</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="nx">log</span><span class="p">.</span><span class="nx">Fatal</span><span class="p">(</span><span class="nx">err</span><span class="p">)</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="nx">err</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="nx">client</span><span class="p">.</span><span class="nx">ChangePermission</span><span class="p">(</span><span class="nx">ctx</span><span class="p">,</span><span class="w"> </span><span class="nx">schema</span><span class="p">.</span><span class="nx">PermissionAction_GRANT</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;myNewUser1&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;defaultDB&quot;</span><span class="p">,</span><span class="w">  </span><span class="nx">auth</span><span class="p">.</span><span class="nx">PermissionRW</span><span class="p">)</span><span class="w"></span>
<span class="k">if</span><span class="w"> </span><span class="nx">err</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="kc">nil</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="nx">log</span><span class="p">.</span><span class="nx">Fatal</span><span class="p">(</span><span class="nx">err</span><span class="p">)</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="nx">err</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="nx">client</span><span class="p">.</span><span class="nx">ChangePassword</span><span class="p">(</span><span class="nx">ctx</span><span class="p">,</span><span class="w"> </span><span class="p">[]</span><span class="nb">byte</span><span class="p">(</span><span class="s">`myNewUser1`</span><span class="p">),</span><span class="w"> </span><span class="p">[]</span><span class="nb">byte</span><span class="p">(</span><span class="s">`myS3cretPassword!`</span><span class="p">),</span><span class="w"> </span><span class="p">[]</span><span class="nb">byte</span><span class="p">(</span><span class="s">`myNewS3cretPassword!`</span><span class="p">))</span><span class="w"></span>
<span class="k">if</span><span class="w"> </span><span class="nx">err</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="kc">nil</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="nx">log</span><span class="p">.</span><span class="nx">Fatal</span><span class="p">(</span><span class="nx">err</span><span class="p">)</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
</pre></div>
</div>
<p>:::</p>
<p>::: tab Java</p>
<div class="highlight-java notranslate"><div class="highlight"><pre><span></span><span class="n">String</span><span class="w"> </span><span class="n">database</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;defaultdb&quot;</span><span class="p">;</span><span class="w"></span>
<span class="n">String</span><span class="w"> </span><span class="n">username</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;testCreateUser&quot;</span><span class="p">;</span><span class="w"></span>
<span class="n">String</span><span class="w"> </span><span class="n">password</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;testTest123!&quot;</span><span class="p">;</span><span class="w"></span>
<span class="n">Permission</span><span class="w"> </span><span class="n">permission</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Permission</span><span class="p">.</span><span class="na">PERMISSION_RW</span><span class="p">;</span><span class="w"></span>

<span class="n">immuClient</span><span class="p">.</span><span class="na">login</span><span class="p">(</span><span class="s">&quot;immudb&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;immudb&quot;</span><span class="p">);</span><span class="w"></span>
<span class="n">immuClient</span><span class="p">.</span><span class="na">useDatabase</span><span class="p">(</span><span class="n">database</span><span class="p">);</span><span class="w"></span>

<span class="k">try</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="n">immuClient</span><span class="p">.</span><span class="na">createUser</span><span class="p">(</span><span class="n">username</span><span class="p">,</span><span class="w"> </span><span class="n">password</span><span class="p">,</span><span class="w"> </span><span class="n">permission</span><span class="p">,</span><span class="w"> </span><span class="n">database</span><span class="p">);</span><span class="w"></span>
<span class="p">}</span><span class="w"> </span><span class="k">catch</span><span class="w"> </span><span class="p">(</span><span class="n">StatusRuntimeException</span><span class="w"> </span><span class="n">e</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&quot;createUser exception: &quot;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">e</span><span class="p">.</span><span class="na">getMessage</span><span class="p">());</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="c1">// We expect getting back the previously created &quot;testCreateUser&quot; user.</span><span class="w"></span>
<span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&quot;listUsers:&quot;</span><span class="p">);</span><span class="w"></span>
<span class="n">List</span><span class="o">&lt;</span><span class="n">User</span><span class="o">&gt;</span><span class="w"> </span><span class="n">users</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">immuClient</span><span class="p">.</span><span class="na">listUsers</span><span class="p">();</span><span class="w"></span>
<span class="n">users</span><span class="p">.</span><span class="na">forEach</span><span class="p">(</span><span class="n">user</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&quot;\t- &quot;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">user</span><span class="p">));</span><span class="w"></span>

<span class="c1">// Changing the user password.</span><span class="w"></span>
<span class="n">immuClient</span><span class="p">.</span><span class="na">changePassword</span><span class="p">(</span><span class="n">username</span><span class="p">,</span><span class="w"> </span><span class="n">password</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;newTestTest123!&quot;</span><span class="p">);</span><span class="w"></span>
</pre></div>
</div>
<p>:::</p>
<p>::: tab Python</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">grpc</span> <span class="kn">import</span> <span class="n">RpcError</span>
<span class="kn">from</span> <span class="nn">immudb</span> <span class="kn">import</span> <span class="n">ImmudbClient</span>
<span class="kn">from</span> <span class="nn">immudb.constants</span> <span class="kn">import</span> <span class="n">PERMISSION_ADMIN</span><span class="p">,</span> <span class="n">PERMISSION_R</span><span class="p">,</span> <span class="n">PERMISSION_RW</span>
<span class="kn">from</span> <span class="nn">immudb.grpc.schema_pb2</span> <span class="kn">import</span> <span class="n">GRANT</span><span class="p">,</span> <span class="n">REVOKE</span>
<span class="kn">from</span> <span class="nn">enum</span> <span class="kn">import</span> <span class="n">IntEnum</span>

<span class="n">URL</span> <span class="o">=</span> <span class="s2">&quot;localhost:3322&quot;</span>  <span class="c1"># immudb running on your machine</span>
<span class="n">LOGIN</span> <span class="o">=</span> <span class="s2">&quot;immudb&quot;</span>        <span class="c1"># Default username</span>
<span class="n">PASSWORD</span> <span class="o">=</span> <span class="s2">&quot;immudb&quot;</span>     <span class="c1"># Default password</span>
<span class="n">DB</span> <span class="o">=</span> <span class="sa">b</span><span class="s2">&quot;defaultdb&quot;</span>       <span class="c1"># Default database name (must be in bytes)</span>

<span class="k">def</span> <span class="nf">main</span><span class="p">():</span>
    <span class="n">client</span> <span class="o">=</span> <span class="n">ImmudbClient</span><span class="p">(</span><span class="n">URL</span><span class="p">)</span>
    <span class="n">client</span><span class="o">.</span><span class="n">login</span><span class="p">(</span><span class="n">LOGIN</span><span class="p">,</span> <span class="n">PASSWORD</span><span class="p">,</span> <span class="n">database</span> <span class="o">=</span> <span class="n">DB</span><span class="p">)</span>
    <span class="n">passwordForNewUsers</span> <span class="o">=</span> <span class="s2">&quot;Te1st!@#Test&quot;</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">client</span><span class="o">.</span><span class="n">createUser</span><span class="p">(</span><span class="s2">&quot;tester1&quot;</span><span class="p">,</span> <span class="n">passwordForNewUsers</span><span class="p">,</span> <span class="n">PERMISSION_R</span><span class="p">,</span> <span class="n">DB</span><span class="p">)</span>
        <span class="n">client</span><span class="o">.</span><span class="n">createUser</span><span class="p">(</span><span class="s2">&quot;tester2&quot;</span><span class="p">,</span> <span class="n">passwordForNewUsers</span><span class="p">,</span> <span class="n">PERMISSION_RW</span><span class="p">,</span> <span class="n">DB</span><span class="p">)</span>
        <span class="n">client</span><span class="o">.</span><span class="n">createUser</span><span class="p">(</span><span class="s2">&quot;tester3&quot;</span><span class="p">,</span> <span class="n">passwordForNewUsers</span><span class="p">,</span> <span class="n">PERMISSION_ADMIN</span><span class="p">,</span> <span class="n">DB</span><span class="p">)</span>
    <span class="k">except</span> <span class="n">RpcError</span> <span class="k">as</span> <span class="n">exception</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">exception</span><span class="o">.</span><span class="n">details</span><span class="p">())</span>

    <span class="n">users</span> <span class="o">=</span> <span class="n">client</span><span class="o">.</span><span class="n">listUsers</span><span class="p">()</span><span class="o">.</span><span class="n">userlist</span><span class="o">.</span><span class="n">users</span> <span class="c1"># immudb.handler.listUsers.listUsersResponse</span>
    <span class="k">for</span> <span class="n">user</span> <span class="ow">in</span> <span class="n">users</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;User&quot;</span><span class="p">,</span> <span class="n">user</span><span class="o">.</span><span class="n">user</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Created by&quot;</span><span class="p">,</span> <span class="n">user</span><span class="o">.</span><span class="n">createdby</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Creation date&quot;</span><span class="p">,</span> <span class="n">user</span><span class="o">.</span><span class="n">createdat</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Is active&quot;</span><span class="p">,</span> <span class="n">user</span><span class="o">.</span><span class="n">active</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">permission</span> <span class="ow">in</span> <span class="n">user</span><span class="o">.</span><span class="n">permissions</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Permission&quot;</span><span class="p">,</span> <span class="n">permission</span><span class="o">.</span><span class="n">database</span><span class="p">,</span> <span class="n">permission</span><span class="o">.</span><span class="n">permission</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;---&quot;</span><span class="p">)</span>

    <span class="n">client</span><span class="o">.</span><span class="n">login</span><span class="p">(</span><span class="s2">&quot;tester3&quot;</span><span class="p">,</span> <span class="n">passwordForNewUsers</span><span class="p">,</span> <span class="n">DB</span><span class="p">)</span>
    <span class="n">client</span><span class="o">.</span><span class="n">changePermission</span><span class="p">(</span><span class="n">GRANT</span><span class="p">,</span> <span class="s2">&quot;tester2&quot;</span><span class="p">,</span> <span class="n">DB</span><span class="p">,</span> <span class="n">PERMISSION_ADMIN</span><span class="p">)</span>
    <span class="n">client</span><span class="o">.</span><span class="n">changePermission</span><span class="p">(</span><span class="n">REVOKE</span><span class="p">,</span> <span class="s2">&quot;tester2&quot;</span><span class="p">,</span> <span class="n">DB</span><span class="p">,</span> <span class="n">PERMISSION_ADMIN</span><span class="p">)</span>

    <span class="n">client</span><span class="o">.</span><span class="n">login</span><span class="p">(</span><span class="n">LOGIN</span><span class="p">,</span> <span class="n">PASSWORD</span><span class="p">,</span> <span class="n">database</span> <span class="o">=</span> <span class="n">DB</span><span class="p">)</span>
    <span class="c1"># Changing password</span>
    <span class="n">client</span><span class="o">.</span><span class="n">changePassword</span><span class="p">(</span><span class="s2">&quot;tester1&quot;</span><span class="p">,</span> <span class="s2">&quot;N1ewpassword!&quot;</span><span class="p">,</span> <span class="n">passwordForNewUsers</span><span class="p">)</span>

    <span class="c1"># User logs with new password</span>
    <span class="n">client</span><span class="o">.</span><span class="n">login</span><span class="p">(</span><span class="s2">&quot;tester1&quot;</span><span class="p">,</span> <span class="s2">&quot;N1ewpassword!&quot;</span><span class="p">)</span>

    <span class="n">client</span><span class="o">.</span><span class="n">login</span><span class="p">(</span><span class="n">LOGIN</span><span class="p">,</span> <span class="n">PASSWORD</span><span class="p">,</span> <span class="n">database</span> <span class="o">=</span> <span class="n">DB</span><span class="p">)</span>
    <span class="n">client</span><span class="o">.</span><span class="n">changePassword</span><span class="p">(</span><span class="s2">&quot;tester1&quot;</span><span class="p">,</span> <span class="n">passwordForNewUsers</span><span class="p">,</span> <span class="s2">&quot;N1ewpassword!&quot;</span><span class="p">)</span>
    

    <span class="n">client</span><span class="o">.</span><span class="n">login</span><span class="p">(</span><span class="s2">&quot;tester1&quot;</span><span class="p">,</span> <span class="n">passwordForNewUsers</span><span class="p">,</span> <span class="n">DB</span><span class="p">)</span>

    <span class="c1"># No permissions to write</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">client</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="sa">b</span><span class="s2">&quot;test&quot;</span><span class="p">,</span> <span class="sa">b</span><span class="s2">&quot;test&quot;</span><span class="p">)</span>
    <span class="k">except</span> <span class="n">RpcError</span> <span class="k">as</span> <span class="n">exception</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">exception</span><span class="o">.</span><span class="n">details</span><span class="p">())</span>

    <span class="c1"># But has permissions to read</span>
    <span class="n">result</span> <span class="o">=</span> <span class="n">client</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="sa">b</span><span class="s2">&quot;test&quot;</span><span class="p">)</span>

    <span class="n">client</span><span class="o">.</span><span class="n">login</span><span class="p">(</span><span class="s2">&quot;tester3&quot;</span><span class="p">,</span> <span class="n">passwordForNewUsers</span><span class="p">,</span> <span class="n">DB</span><span class="p">)</span>

    <span class="c1"># Now will have permissions to write</span>
    <span class="n">client</span><span class="o">.</span><span class="n">changePermission</span><span class="p">(</span><span class="n">GRANT</span><span class="p">,</span> <span class="s2">&quot;tester1&quot;</span><span class="p">,</span> <span class="n">DB</span><span class="p">,</span> <span class="n">PERMISSION_RW</span><span class="p">)</span>
    <span class="n">client</span><span class="o">.</span><span class="n">login</span><span class="p">(</span><span class="s2">&quot;tester1&quot;</span><span class="p">,</span> <span class="n">passwordForNewUsers</span><span class="p">,</span> <span class="n">DB</span><span class="p">)</span>
    <span class="n">client</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="sa">b</span><span class="s2">&quot;test&quot;</span><span class="p">,</span> <span class="sa">b</span><span class="s2">&quot;test&quot;</span><span class="p">)</span>
    <span class="n">result</span> <span class="o">=</span> <span class="n">client</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="sa">b</span><span class="s2">&quot;test&quot;</span><span class="p">)</span>

    <span class="n">client</span><span class="o">.</span><span class="n">login</span><span class="p">(</span><span class="s2">&quot;tester3&quot;</span><span class="p">,</span> <span class="n">passwordForNewUsers</span><span class="p">,</span> <span class="n">DB</span><span class="p">)</span>

    <span class="c1"># Now will have permissions to nothing</span>
    <span class="n">client</span><span class="o">.</span><span class="n">changePermission</span><span class="p">(</span><span class="n">REVOKE</span><span class="p">,</span> <span class="s2">&quot;tester1&quot;</span><span class="p">,</span> <span class="n">DB</span><span class="p">,</span> <span class="n">PERMISSION_RW</span><span class="p">)</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="n">client</span><span class="o">.</span><span class="n">login</span><span class="p">(</span><span class="s2">&quot;tester1&quot;</span><span class="p">,</span> <span class="n">passwordForNewUsers</span><span class="p">,</span> <span class="n">DB</span><span class="p">)</span>
    <span class="k">except</span> <span class="n">RpcError</span> <span class="k">as</span> <span class="n">exception</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">exception</span><span class="o">.</span><span class="n">details</span><span class="p">())</span>
    
    <span class="n">client</span><span class="o">.</span><span class="n">login</span><span class="p">(</span><span class="s2">&quot;tester3&quot;</span><span class="p">,</span> <span class="n">passwordForNewUsers</span><span class="p">,</span> <span class="n">DB</span><span class="p">)</span>
    <span class="n">client</span><span class="o">.</span><span class="n">changePermission</span><span class="p">(</span><span class="n">GRANT</span><span class="p">,</span> <span class="s2">&quot;tester1&quot;</span><span class="p">,</span> <span class="n">DB</span><span class="p">,</span> <span class="n">PERMISSION_RW</span><span class="p">)</span>


<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>
    <span class="n">main</span><span class="p">()</span>
</pre></div>
</div>
<p>:::</p>
<p>::: tab Node.js</p>
<div class="highlight-ts notranslate"><div class="highlight"><pre><span></span><span class="k">import</span><span class="w"> </span><span class="nx">ImmudbClient</span><span class="w"> </span><span class="kr">from</span><span class="w"> </span><span class="s1">&#39;immudb-node&#39;</span><span class="w"></span>
<span class="k">import</span><span class="w"> </span><span class="nx">Parameters</span><span class="w"> </span><span class="kr">from</span><span class="w"> </span><span class="s1">&#39;immudb-node/types/parameters&#39;</span><span class="w"></span>
<span class="k">import</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">USER_ACTION</span><span class="p">,</span><span class="w"> </span><span class="nx">USER_PERMISSION</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="kr">from</span><span class="w"> </span><span class="s1">&#39;immudb-node/dist/types/user&#39;</span><span class="w"></span>

<span class="kd">const</span><span class="w"> </span><span class="nx">IMMUDB_HOST</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;127.0.0.1&#39;</span><span class="w"></span>
<span class="kd">const</span><span class="w"> </span><span class="nx">IMMUDB_PORT</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;3322&#39;</span><span class="w"></span>
<span class="kd">const</span><span class="w"> </span><span class="nx">IMMUDB_USER</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;immudb&#39;</span><span class="w"></span>
<span class="kd">const</span><span class="w"> </span><span class="nx">IMMUDB_PWD</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;immudb&#39;</span><span class="w"></span>

<span class="kd">const</span><span class="w"> </span><span class="nx">cl</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="nx">ImmudbClient</span><span class="p">({</span><span class="w"> </span><span class="nx">host</span><span class="o">:</span><span class="w"> </span><span class="kt">IMMUDB_HOST</span><span class="p">,</span><span class="w"> </span><span class="nx">port</span><span class="o">:</span><span class="w"> </span><span class="kt">IMMUDB_PORT</span><span class="w"> </span><span class="p">});</span><span class="w"></span>

<span class="p">(</span><span class="k">async</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">	</span><span class="k">await</span><span class="w"> </span><span class="nx">cl</span><span class="p">.</span><span class="nx">login</span><span class="p">({</span><span class="w"> </span><span class="nx">user</span><span class="o">:</span><span class="w"> </span><span class="kt">IMMUDB_USER</span><span class="p">,</span><span class="w"> </span><span class="nx">password</span><span class="o">:</span><span class="w"> </span><span class="kt">IMMUDB_PWD</span><span class="w"> </span><span class="p">})</span><span class="w"></span>

<span class="w">	</span><span class="kd">const</span><span class="w"> </span><span class="nx">createUserRequest</span><span class="o">:</span><span class="w"> </span><span class="kt">Parameters.CreateUser</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">		</span><span class="nx">user</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;myNewUser1&#39;</span><span class="p">,</span><span class="w"></span>
<span class="w">		</span><span class="nx">password</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;myS3cretPassword!&#39;</span><span class="p">,</span><span class="w"></span>
<span class="w">		</span><span class="nx">permission</span><span class="o">:</span><span class="w"> </span><span class="kt">USER_PERMISSION.READ_ONLY</span><span class="p">,</span><span class="w"></span>
<span class="w">		</span><span class="nx">database</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;defaultdb&#39;</span><span class="p">,</span><span class="w"></span>
<span class="w">	</span><span class="p">};</span><span class="w"></span>
<span class="w">	</span><span class="kd">const</span><span class="w"> </span><span class="nx">createUserRes</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">cl</span><span class="p">.</span><span class="nx">createUser</span><span class="p">(</span><span class="nx">createUserRequest</span><span class="p">)</span><span class="w"></span>
<span class="w">	</span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;success: createUser&#39;</span><span class="p">,</span><span class="w"> </span><span class="nx">createUserRes</span><span class="p">)</span><span class="w"></span>

<span class="w">	</span><span class="kd">const</span><span class="w"> </span><span class="nx">changePermissionReq</span><span class="o">:</span><span class="w"> </span><span class="kt">Parameters.ChangePermission</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">		</span><span class="nx">action</span><span class="o">:</span><span class="w"> </span><span class="kt">USER_ACTION.GRANT</span><span class="p">,</span><span class="w"></span>
<span class="w">		</span><span class="nx">username</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;myNewUser1&#39;</span><span class="p">,</span><span class="w"></span>
<span class="w">		</span><span class="nx">database</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;defaultDB&#39;</span><span class="p">,</span><span class="w"></span>
<span class="w">		</span><span class="nx">permission</span><span class="o">:</span><span class="w"> </span><span class="kt">USER_PERMISSION.READ_WRITE</span><span class="w"></span>
<span class="w">	</span><span class="p">}</span><span class="w"></span>
<span class="w">	</span><span class="kd">const</span><span class="w"> </span><span class="nx">changePermissionRes</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">await</span><span class="w"> </span><span class="nx">cl</span><span class="p">.</span><span class="nx">changePermission</span><span class="p">(</span><span class="nx">changePermissionReq</span><span class="p">)</span><span class="w"></span>
<span class="w">	</span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;success: changePermission&#39;</span><span class="p">,</span><span class="w"> </span><span class="nx">changePermissionRes</span><span class="p">)</span><span class="w"></span>

<span class="w">	</span><span class="kd">const</span><span class="w"> </span><span class="nx">changePasswordReq</span><span class="o">:</span><span class="w"> </span><span class="kt">Parameters.ChangePassword</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">		</span><span class="nx">user</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;myNewUser1&#39;</span><span class="p">,</span><span class="w"></span>
<span class="w">		</span><span class="nx">oldpassword</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;myS3cretPassword!&#39;</span><span class="p">,</span><span class="w"></span>
<span class="w">		</span><span class="nx">newpassword</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;myNewS3cretPassword!&#39;</span><span class="w"></span>
<span class="w">	</span><span class="p">}</span><span class="w"></span>
<span class="w">	</span><span class="kd">const</span><span class="w"> </span><span class="nx">changePasswordRes</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">await</span><span class="w"> </span><span class="nx">cl</span><span class="p">.</span><span class="nx">changePassword</span><span class="p">(</span><span class="nx">changePasswordReq</span><span class="p">)</span><span class="w"></span>
<span class="w">	</span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;success: changePassword&#39;</span><span class="p">,</span><span class="w"> </span><span class="nx">changePermissionRes</span><span class="p">)</span><span class="w"></span>
<span class="p">})()</span><span class="w"></span>
</pre></div>
</div>
<p>:::</p>
<p>::: tab .Net
This feature is not yet supported or not documented.
Do you want to make a feature request or help out? Open an issue on <a class="reference external" href="https://github.com/codenotary/immudb4dotnet/issues/new">.Net sdk github project</a>
:::</p>
<p>::: tab Others
If you’re using another development language, please refer to the <a class="reference internal" href="immugw.html"><span class="doc std std-doc">immugw</span></a> option.
:::</p>
<p>::::</p>
<br/>
</section>
<section id="database-management">
<h2>Database management<a class="headerlink" href="#database-management" title="Permalink to this heading">¶</a></h2>
<p>Multi-database support is included in immudb server. immudb automatically creates an initial database named <code class="docutils literal notranslate"><span class="pre">defaultdb</span></code>.</p>
<p>Managing users and databases requires the appropriate privileges. A user with <code class="docutils literal notranslate"><span class="pre">PermissionAdmin</span></code> rights can manage everything. Non-admin users have restricted access and can only read or write databases to which they have been granted permission.</p>
<p>Each database can be configured with a variety of settings. While some values can be changed at any time (though it may require a database reload to take effect), following ones are fixed and cannot be changed: FileSize, MaxKeyLen, MaxValueLen, MaxTxEntries and IndexOptions.MaxNodeSize.</p>
<section id="configuration-options">
<h3>Configuration options<a class="headerlink" href="#configuration-options" title="Permalink to this heading">¶</a></h3>
<p>Following main database options are available:</p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Name</p></th>
<th class="head"><p>Type</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>replicationSettings</p></td>
<td><p>Replication Setings</p></td>
<td><p>Repliation settings are described below</p></td>
</tr>
<tr class="row-odd"><td><p>indexSettings</p></td>
<td><p>Index Settings</p></td>
<td><p>Index settings are described below</p></td>
</tr>
<tr class="row-even"><td><p>fileSize</p></td>
<td><p>Uint32</p></td>
<td><p>maximum file size of files on disk generated by immudb</p></td>
</tr>
<tr class="row-odd"><td><p>maxKeyLen</p></td>
<td><p>Uint32</p></td>
<td><p>maximum length of keys for entries stored in the database</p></td>
</tr>
<tr class="row-even"><td><p>maxValueLen</p></td>
<td><p>Uint32</p></td>
<td><p>maximum length of values for entries stored in the database</p></td>
</tr>
<tr class="row-odd"><td><p>maxTxEntries</p></td>
<td><p>Uint32</p></td>
<td><p>maximum number of entries inside one transaction</p></td>
</tr>
<tr class="row-even"><td><p>excludeCommitTime</p></td>
<td><p>Bool</p></td>
<td><p>if set to true, commit time is not added to transaction headers allowing reproducible database state</p></td>
</tr>
<tr class="row-odd"><td><p>maxConcurrency</p></td>
<td><p>Uint32</p></td>
<td><p>max number of concurrent operations on the db</p></td>
</tr>
<tr class="row-even"><td><p>maxIOConcurrency</p></td>
<td><p>Uint32</p></td>
<td><p>max number of concurrent IO operations on the db</p></td>
</tr>
<tr class="row-odd"><td><p>txLogCacheSize</p></td>
<td><p>Uint32</p></td>
<td><p>size of transaction log cache</p></td>
</tr>
<tr class="row-even"><td><p>vLogMaxOpenedFiles</p></td>
<td><p>Uint32</p></td>
<td><p>maximum number of open files for payload data</p></td>
</tr>
<tr class="row-odd"><td><p>txLogMaxOpenedFiles</p></td>
<td><p>Uint32</p></td>
<td><p>maximum number of open files for transaction log</p></td>
</tr>
<tr class="row-even"><td><p>commitLogMaxOpenedFiles</p></td>
<td><p>Uint32</p></td>
<td><p>maximum number of open files for commit log</p></td>
</tr>
<tr class="row-odd"><td><p>writeTxHeaderVersion</p></td>
<td><p>Uint32</p></td>
<td><p>transaction header version, used for backwards compatibility</p></td>
</tr>
<tr class="row-even"><td><p>autoload</p></td>
<td><p>Bool</p></td>
<td><p>if set to false, do not load database on startup</p></td>
</tr>
</tbody>
</table>
<p>Replication settings:</p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Name</p></th>
<th class="head"><p>Type</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>replica</p></td>
<td><p>Bool</p></td>
<td><p>if true, the database is a replica of another one</p></td>
</tr>
<tr class="row-odd"><td><p>masterDatabase</p></td>
<td><p>String</p></td>
<td><p>name of the database to replicate</p></td>
</tr>
<tr class="row-even"><td><p>masterAddress</p></td>
<td><p>String</p></td>
<td><p>hostname of the master immudb instance</p></td>
</tr>
<tr class="row-odd"><td><p>masterPort</p></td>
<td><p>Uint32</p></td>
<td><p>tcp port of the master immudb instance</p></td>
</tr>
<tr class="row-even"><td><p>followerUsername</p></td>
<td><p>String</p></td>
<td><p>username used to connect to the master immudb instance</p></td>
</tr>
<tr class="row-odd"><td><p>followerPassword</p></td>
<td><p>String</p></td>
<td><p>password used to connect to the master immudb instance</p></td>
</tr>
</tbody>
</table>
<p>Additional index options:</p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Name</p></th>
<th class="head"><p>Type</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>flushThreshold</p></td>
<td><p>Uint32</p></td>
<td><p>threshold in number of entries between automatic flushes</p></td>
</tr>
<tr class="row-odd"><td><p>syncThreshold</p></td>
<td><p>Uint32</p></td>
<td><p>threshold in number of entries between flushes with sync</p></td>
</tr>
<tr class="row-even"><td><p>cacheSize</p></td>
<td><p>Uint32</p></td>
<td><p>size of btree node cache</p></td>
</tr>
<tr class="row-odd"><td><p>maxNodeSize</p></td>
<td><p>Uint32</p></td>
<td><p>max size of btree node in bytes</p></td>
</tr>
<tr class="row-even"><td><p>maxActiveSnapshots</p></td>
<td><p>Uint32</p></td>
<td><p>max number of active in-memory btree snapshots</p></td>
</tr>
<tr class="row-odd"><td><p>renewSnapRootAfter</p></td>
<td><p>Uint64</p></td>
<td><p>threshold in time for automated snapshot renewal during data scans</p></td>
</tr>
<tr class="row-even"><td><p>compactionThld</p></td>
<td><p>Uint32</p></td>
<td><p>minimum number of flushed snapshots to enable full compaction of the index</p></td>
</tr>
<tr class="row-odd"><td><p>delayDuringCompaction</p></td>
<td><p>Uint32</p></td>
<td><p>extra delay added during indexing when full compaction is in progress</p></td>
</tr>
<tr class="row-even"><td><p>nodesLogMaxOpenedFiles</p></td>
<td><p>Uint32</p></td>
<td><p>maximum number of files opened for nodes data</p></td>
</tr>
<tr class="row-odd"><td><p>historyLogMaxOpenedFiles</p></td>
<td><p>Uint32</p></td>
<td><p>maximum number of files opened for nodes history</p></td>
</tr>
<tr class="row-even"><td><p>commitLogMaxOpenedFiles</p></td>
<td><p>Uint32</p></td>
<td><p>maximum number of files opened for commit log</p></td>
</tr>
<tr class="row-odd"><td><p>flushBufferSize</p></td>
<td><p>Uint32</p></td>
<td><p>in-memory buffer size when doing flush operation</p></td>
</tr>
<tr class="row-even"><td><p>cleanupPercentage</p></td>
<td><p>Float</p></td>
<td><p>% of data to be cleaned up from during next automatic flush operation</p></td>
</tr>
</tbody>
</table>
</section>
<section id="database-creation-and-selection">
<h3>Database creation and selection<a class="headerlink" href="#database-creation-and-selection" title="Permalink to this heading">¶</a></h3>
<p>This example shows how to create a new database and how to write records to it.
To create a new database, use <code class="docutils literal notranslate"><span class="pre">CreateDatabaseV2</span></code> method then <code class="docutils literal notranslate"><span class="pre">UseDatabase</span></code> to select the newly created one.</p>
<p>:::: tabs</p>
<p>::: tab Go</p>
<div class="highlight-go notranslate"><div class="highlight"><pre><span></span><span class="nx">client</span><span class="p">,</span><span class="w"> </span><span class="nx">err</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="nx">immudb</span><span class="p">.</span><span class="nx">NewClient</span><span class="p">()</span><span class="w"></span>
<span class="k">if</span><span class="w"> </span><span class="nx">err</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="kc">nil</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="nx">log</span><span class="p">.</span><span class="nx">Fatal</span><span class="p">(</span><span class="nx">err</span><span class="p">)</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="nx">ctx</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="nx">context</span><span class="p">.</span><span class="nx">Background</span><span class="p">()</span><span class="w"></span>

<span class="nx">err</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="nx">client</span><span class="p">.</span><span class="nx">OpenSession</span><span class="p">(</span><span class="nx">ctx</span><span class="p">,</span><span class="w"> </span><span class="p">[]</span><span class="nb">byte</span><span class="p">(</span><span class="s">`immudb`</span><span class="p">),</span><span class="w"> </span><span class="p">[]</span><span class="nb">byte</span><span class="p">(</span><span class="s">`immudb`</span><span class="p">),</span><span class="w"> </span><span class="s">&quot;defaultdb&quot;</span><span class="p">)</span><span class="w"></span>
<span class="k">if</span><span class="w"> </span><span class="nx">err</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="kc">nil</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="nx">log</span><span class="p">.</span><span class="nx">Fatal</span><span class="p">(</span><span class="nx">err</span><span class="p">)</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="k">defer</span><span class="w"> </span><span class="nx">client</span><span class="p">.</span><span class="nx">CloseSession</span><span class="p">(</span><span class="nx">ctx</span><span class="p">)</span><span class="w"></span>

<span class="nx">err</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="nx">client</span><span class="p">.</span><span class="nx">CreateDatabaseV2</span><span class="p">(</span><span class="nx">ctx</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;myimmutabledb&quot;</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="nx">schema</span><span class="p">.</span><span class="nx">DatabaseNullableSettings</span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="nx">MaxConcurrency</span><span class="p">:</span><span class="w"> </span><span class="mi">10</span><span class="p">,</span><span class="w"> </span><span class="c1">// this setting determines how many transactions can be handled concurrently</span><span class="w"></span>
<span class="p">})</span><span class="w"></span>
<span class="k">if</span><span class="w"> </span><span class="nx">err</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="kc">nil</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="nx">log</span><span class="p">.</span><span class="nx">Fatal</span><span class="p">(</span><span class="nx">err</span><span class="p">)</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="nx">_</span><span class="p">,</span><span class="w"> </span><span class="nx">err</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="nx">client</span><span class="p">.</span><span class="nx">UseDatabase</span><span class="p">(</span><span class="nx">ctx</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="nx">schema</span><span class="p">.</span><span class="nx">Database</span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="nx">Databasename</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;myimmutabledb&quot;</span><span class="p">,</span><span class="w"></span>
<span class="p">})</span><span class="w"></span>
<span class="k">if</span><span class="w"> </span><span class="nx">err</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="kc">nil</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="nx">log</span><span class="p">.</span><span class="nx">Fatal</span><span class="p">(</span><span class="nx">err</span><span class="p">)</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="c1">// writing in myimmutabledb</span><span class="w"></span>
<span class="nx">_</span><span class="p">,</span><span class="w"> </span><span class="nx">err</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="nx">client</span><span class="p">.</span><span class="nx">Set</span><span class="p">(</span><span class="nx">ctx</span><span class="p">,</span><span class="w"> </span><span class="p">[]</span><span class="nb">byte</span><span class="p">(</span><span class="s">`key`</span><span class="p">),</span><span class="w"> </span><span class="p">[]</span><span class="nb">byte</span><span class="p">(</span><span class="s">`val`</span><span class="p">))</span><span class="w"></span>
<span class="k">if</span><span class="w"> </span><span class="nx">err</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="kc">nil</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="nx">log</span><span class="p">.</span><span class="nx">Fatal</span><span class="p">(</span><span class="nx">err</span><span class="p">)</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
</pre></div>
</div>
<p>:::</p>
<p>::: tab Java</p>
<div class="highlight-java notranslate"><div class="highlight"><pre><span></span><span class="n">immuClient</span><span class="p">.</span><span class="na">createDatabase</span><span class="p">(</span><span class="s">&quot;db1&quot;</span><span class="p">);</span><span class="w"></span>
<span class="n">immuClient</span><span class="p">.</span><span class="na">createDatabase</span><span class="p">(</span><span class="s">&quot;db2&quot;</span><span class="p">);</span><span class="w"></span>

<span class="n">immuClient</span><span class="p">.</span><span class="na">useDatabase</span><span class="p">(</span><span class="s">&quot;db1&quot;</span><span class="p">);</span><span class="w"></span>

<span class="k">try</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="n">immuClient</span><span class="p">.</span><span class="na">set</span><span class="p">(</span><span class="s">&quot;k0&quot;</span><span class="p">,</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="kt">byte</span><span class="o">[]</span><span class="p">{</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">});</span><span class="w"></span>
<span class="p">}</span><span class="w"> </span><span class="k">catch</span><span class="w"> </span><span class="p">(</span><span class="n">CorruptedDataException</span><span class="w"> </span><span class="n">e</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="c1">// ...</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
</pre></div>
</div>
<p>:::</p>
<p>::: tab Python</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">immudb</span> <span class="kn">import</span> <span class="n">ImmudbClient</span>

<span class="n">URL</span> <span class="o">=</span> <span class="s2">&quot;localhost:3322&quot;</span>  <span class="c1"># immudb running on your machine</span>
<span class="n">LOGIN</span> <span class="o">=</span> <span class="s2">&quot;immudb&quot;</span>        <span class="c1"># Default username</span>
<span class="n">PASSWORD</span> <span class="o">=</span> <span class="s2">&quot;immudb&quot;</span>     <span class="c1"># Default password</span>
<span class="n">DB</span> <span class="o">=</span> <span class="sa">b</span><span class="s2">&quot;defaultdb&quot;</span>       <span class="c1"># Default database name (must be in bytes)</span>

<span class="k">def</span> <span class="nf">main</span><span class="p">():</span>
    <span class="n">client</span> <span class="o">=</span> <span class="n">ImmudbClient</span><span class="p">(</span><span class="n">URL</span><span class="p">)</span>
    <span class="n">client</span><span class="o">.</span><span class="n">login</span><span class="p">(</span><span class="n">LOGIN</span><span class="p">,</span> <span class="n">PASSWORD</span><span class="p">,</span> <span class="n">database</span> <span class="o">=</span> <span class="n">DB</span><span class="p">)</span>
    <span class="n">testDatabase</span> <span class="o">=</span> <span class="s2">&quot;test&quot;</span>
    
    <span class="n">databases</span> <span class="o">=</span> <span class="n">client</span><span class="o">.</span><span class="n">databaseList</span><span class="p">()</span>
    <span class="k">if</span><span class="p">(</span><span class="n">testDatabase</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">databases</span><span class="p">):</span>
        <span class="n">client</span><span class="o">.</span><span class="n">createDatabase</span><span class="p">(</span><span class="n">testDatabase</span><span class="p">)</span>

    <span class="n">client</span><span class="o">.</span><span class="n">useDatabase</span><span class="p">(</span><span class="s2">&quot;test&quot;</span><span class="p">)</span>
    <span class="n">client</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="sa">b</span><span class="s2">&quot;test&quot;</span><span class="p">,</span> <span class="sa">b</span><span class="s2">&quot;test&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">client</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="sa">b</span><span class="s2">&quot;test&quot;</span><span class="p">))</span>

<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>
    <span class="n">main</span><span class="p">()</span>
</pre></div>
</div>
<p>:::</p>
<p>::: tab Node.js</p>
<div class="highlight-ts notranslate"><div class="highlight"><pre><span></span><span class="k">import</span><span class="w"> </span><span class="nx">ImmudbClient</span><span class="w"> </span><span class="kr">from</span><span class="w"> </span><span class="s1">&#39;immudb-node&#39;</span><span class="w"></span>
<span class="k">import</span><span class="w"> </span><span class="nx">Parameters</span><span class="w"> </span><span class="kr">from</span><span class="w"> </span><span class="s1">&#39;immudb-node/types/parameters&#39;</span><span class="w"></span>

<span class="kd">const</span><span class="w"> </span><span class="nx">IMMUDB_HOST</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;127.0.0.1&#39;</span><span class="w"></span>
<span class="kd">const</span><span class="w"> </span><span class="nx">IMMUDB_PORT</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;3322&#39;</span><span class="w"></span>
<span class="kd">const</span><span class="w"> </span><span class="nx">IMMUDB_USER</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;immudb&#39;</span><span class="w"></span>
<span class="kd">const</span><span class="w"> </span><span class="nx">IMMUDB_PWD</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;immudb&#39;</span><span class="w"></span>

<span class="kd">const</span><span class="w"> </span><span class="nx">cl</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="nx">ImmudbClient</span><span class="p">({</span><span class="w"> </span><span class="nx">host</span><span class="o">:</span><span class="w"> </span><span class="kt">IMMUDB_HOST</span><span class="p">,</span><span class="w"> </span><span class="nx">port</span><span class="o">:</span><span class="w"> </span><span class="kt">IMMUDB_PORT</span><span class="w"> </span><span class="p">});</span><span class="w"></span>

<span class="p">(</span><span class="k">async</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">	</span><span class="k">await</span><span class="w"> </span><span class="nx">cl</span><span class="p">.</span><span class="nx">login</span><span class="p">({</span><span class="w"> </span><span class="nx">user</span><span class="o">:</span><span class="w"> </span><span class="kt">IMMUDB_USER</span><span class="p">,</span><span class="w"> </span><span class="nx">password</span><span class="o">:</span><span class="w"> </span><span class="kt">IMMUDB_PWD</span><span class="w"> </span><span class="p">})</span><span class="w"></span>

<span class="w">	</span><span class="kd">const</span><span class="w"> </span><span class="nx">createDatabaseReq</span><span class="o">:</span><span class="w"> </span><span class="kt">Parameters.CreateDatabase</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">		</span><span class="nx">databasename</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;myimmutabledb&#39;</span><span class="w"></span>
<span class="w">	</span><span class="p">}</span><span class="w"></span>

<span class="w">	</span><span class="kd">const</span><span class="w"> </span><span class="nx">createDatabaseRes</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">await</span><span class="w"> </span><span class="nx">cl</span><span class="p">.</span><span class="nx">createDatabase</span><span class="p">(</span><span class="nx">createDatabaseReq</span><span class="p">)</span><span class="w"></span>
<span class="w">	</span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;success: createDatabase&#39;</span><span class="p">,</span><span class="w"> </span><span class="nx">createDatabaseRes</span><span class="p">)</span><span class="w"></span>

<span class="w">	</span><span class="kd">const</span><span class="w"> </span><span class="nx">useDatabaseReq</span><span class="o">:</span><span class="w"> </span><span class="kt">Parameters.UseDatabase</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">		</span><span class="nx">databasename</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;myimmutabledb&#39;</span><span class="w"></span>
<span class="w">	</span><span class="p">}</span><span class="w"></span>
<span class="w">	</span><span class="kd">const</span><span class="w"> </span><span class="nx">useDatabaseRes</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">await</span><span class="w"> </span><span class="nx">cl</span><span class="p">.</span><span class="nx">useDatabase</span><span class="p">(</span><span class="nx">useDatabaseReq</span><span class="p">)</span><span class="w"></span>
<span class="w">	</span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;success: useDatabase&#39;</span><span class="p">,</span><span class="w"> </span><span class="nx">useDatabaseRes</span><span class="p">)</span><span class="w"></span>

<span class="w">	</span><span class="k">await</span><span class="w"> </span><span class="nx">cl</span><span class="p">.</span><span class="nx">set</span><span class="p">(</span><span class="s1">&#39;key&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;val&#39;</span><span class="p">)</span><span class="w"></span>
<span class="p">})()</span><span class="w"></span>
</pre></div>
</div>
<p>:::</p>
<p>::: tab .Net
This feature is not yet supported or not documented.
Do you want to make a feature request or help out? Open an issue on <a class="reference external" href="https://github.com/codenotary/immudb4dotnet/issues/new">.Net sdk github project</a>
:::</p>
<p>::: tab Others
If you’re using another development language, please refer to the <a class="reference internal" href="immugw.html"><span class="doc std std-doc">immugw</span></a> option.
:::</p>
<p>::::</p>
</section>
<section id="database-listing">
<h3>Database listing<a class="headerlink" href="#database-listing" title="Permalink to this heading">¶</a></h3>
<p>This example shows how to list existent databases using <code class="docutils literal notranslate"><span class="pre">DatabaseListV2</span></code> method.</p>
<p>:::: tabs</p>
<p>::: tab Go</p>
<div class="highlight-go notranslate"><div class="highlight"><pre><span></span><span class="nx">client</span><span class="p">,</span><span class="w"> </span><span class="nx">err</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="nx">immudb</span><span class="p">.</span><span class="nx">NewClient</span><span class="p">()</span><span class="w"></span>
<span class="k">if</span><span class="w"> </span><span class="nx">err</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="kc">nil</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="nx">log</span><span class="p">.</span><span class="nx">Fatal</span><span class="p">(</span><span class="nx">err</span><span class="p">)</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="nx">ctx</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="nx">context</span><span class="p">.</span><span class="nx">Background</span><span class="p">()</span><span class="w"></span>

<span class="nx">err</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="nx">client</span><span class="p">.</span><span class="nx">OpenSession</span><span class="p">(</span><span class="nx">ctx</span><span class="p">,</span><span class="w"> </span><span class="p">[]</span><span class="nb">byte</span><span class="p">(</span><span class="s">`immudb`</span><span class="p">),</span><span class="w"> </span><span class="p">[]</span><span class="nb">byte</span><span class="p">(</span><span class="s">`immudb`</span><span class="p">),</span><span class="w"> </span><span class="s">&quot;defaultdb&quot;</span><span class="p">)</span><span class="w"></span>
<span class="k">if</span><span class="w"> </span><span class="nx">err</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="kc">nil</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="nx">log</span><span class="p">.</span><span class="nx">Fatal</span><span class="p">(</span><span class="nx">err</span><span class="p">)</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="k">defer</span><span class="w"> </span><span class="nx">client</span><span class="p">.</span><span class="nx">CloseSession</span><span class="p">(</span><span class="nx">ctx</span><span class="p">)</span><span class="w"></span>

<span class="nx">res</span><span class="p">,</span><span class="w"> </span><span class="nx">err</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="nx">client</span><span class="p">.</span><span class="nx">DatabaseListV2</span><span class="p">(</span><span class="nx">ctx</span><span class="p">)</span><span class="w"></span>
<span class="k">if</span><span class="w"> </span><span class="nx">err</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="kc">nil</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="nx">log</span><span class="p">.</span><span class="nx">Fatal</span><span class="p">(</span><span class="nx">err</span><span class="p">)</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="k">for</span><span class="w"> </span><span class="nx">_</span><span class="p">,</span><span class="w"> </span><span class="nx">db</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="k">range</span><span class="w"> </span><span class="nx">res</span><span class="p">.</span><span class="nx">Databases</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="nx">fmt</span><span class="p">.</span><span class="nx">Printf</span><span class="p">(</span><span class="s">&quot;database: %s, loaded: %v\r\n&quot;</span><span class="p">,</span><span class="w"> </span><span class="nx">db</span><span class="p">.</span><span class="nx">Name</span><span class="p">,</span><span class="w"> </span><span class="nx">db</span><span class="p">.</span><span class="nx">Loaded</span><span class="p">)</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
</pre></div>
</div>
<p>:::</p>
<p>::: tab Java</p>
<div class="highlight-java notranslate"><div class="highlight"><pre><span></span><span class="n">List</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;</span><span class="w"> </span><span class="n">dbs</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">immuClient</span><span class="p">.</span><span class="na">databases</span><span class="p">();</span><span class="w"></span>
<span class="c1">// List of database names</span><span class="w"></span>
</pre></div>
</div>
<p>:::</p>
<p>::: tab Python
This feature is not yet supported or not documented.
Do you want to make a feature request or help out? Open an issue on <a class="reference external" href="https://github.com/codenotary/immudb-py/issues/new">Python sdk github project</a>
:::</p>
<p>::: tab Node.js
This feature is not yet supported or not documented.
Do you want to make a feature request or help out? Open an issue on <a class="reference external" href="https://github.com/codenotary/immudb-node/issues/new">Node.js sdk github project</a>
:::</p>
<p>::: tab .Net
This feature is not yet supported or not documented.
Do you want to make a feature request or help out? Open an issue on <a class="reference external" href="https://github.com/codenotary/immudb4dotnet/issues/new">.Net sdk github project</a>
:::</p>
<p>::: tab Others
If you’re using another development language, please refer to the <a class="reference internal" href="immugw.html"><span class="doc std std-doc">immugw</span></a> option.
:::</p>
<p>::::</p>
</section>
<section id="database-loading-unloading">
<h3>Database loading/unloading<a class="headerlink" href="#database-loading-unloading" title="Permalink to this heading">¶</a></h3>
<p>Databases can be dynamically loaded and unloaded without having to restart the server. After the database is unloaded, all its resources are released. Unloaded databases cannot be queried or written to, but their settings can still be changed.
Upon startup, the immudb server will automatically load databases with the attribute <code class="docutils literal notranslate"><span class="pre">Autoload</span></code> set to true. If a user-created database cannot be loaded successfully, it remains closed, but the server continues to run normally.
As a default, autoloading is enabled when creating a database, but it can be disabled during creation or turned on/off at any time thereafter.</p>
<p>Following example shows how to load and unload a database using <code class="docutils literal notranslate"><span class="pre">LoadDatabase</span></code> and <code class="docutils literal notranslate"><span class="pre">UnloadDatabase</span></code> methods.</p>
<p>:::: tabs</p>
<p>::: tab Go</p>
<div class="highlight-go notranslate"><div class="highlight"><pre><span></span><span class="nx">client</span><span class="p">,</span><span class="w"> </span><span class="nx">err</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="nx">immudb</span><span class="p">.</span><span class="nx">NewClient</span><span class="p">()</span><span class="w"></span>
<span class="k">if</span><span class="w"> </span><span class="nx">err</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="kc">nil</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="nx">log</span><span class="p">.</span><span class="nx">Fatal</span><span class="p">(</span><span class="nx">err</span><span class="p">)</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="nx">ctx</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="nx">context</span><span class="p">.</span><span class="nx">Background</span><span class="p">()</span><span class="w"></span>

<span class="nx">err</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="nx">client</span><span class="p">.</span><span class="nx">OpenSession</span><span class="p">(</span><span class="nx">ctx</span><span class="p">,</span><span class="w"> </span><span class="p">[]</span><span class="nb">byte</span><span class="p">(</span><span class="s">`immudb`</span><span class="p">),</span><span class="w"> </span><span class="p">[]</span><span class="nb">byte</span><span class="p">(</span><span class="s">`immudb`</span><span class="p">),</span><span class="w"> </span><span class="s">&quot;defaultdb&quot;</span><span class="p">)</span><span class="w"></span>
<span class="k">if</span><span class="w"> </span><span class="nx">err</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="kc">nil</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="nx">log</span><span class="p">.</span><span class="nx">Fatal</span><span class="p">(</span><span class="nx">err</span><span class="p">)</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="k">defer</span><span class="w"> </span><span class="nx">client</span><span class="p">.</span><span class="nx">CloseSession</span><span class="p">(</span><span class="nx">ctx</span><span class="p">)</span><span class="w"></span>

<span class="nx">_</span><span class="p">,</span><span class="w"> </span><span class="nx">err</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="nx">client</span><span class="p">.</span><span class="nx">LoadDatabase</span><span class="p">(</span><span class="nx">ctx</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="nx">schema</span><span class="p">.</span><span class="nx">LoadDatabaseRequest</span><span class="p">{</span><span class="nx">Database</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;mydb&quot;</span><span class="p">})</span><span class="w"></span>
<span class="k">if</span><span class="w"> </span><span class="nx">err</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="kc">nil</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="nx">log</span><span class="p">.</span><span class="nx">Fatal</span><span class="p">(</span><span class="nx">err</span><span class="p">)</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="nx">_</span><span class="p">,</span><span class="w"> </span><span class="nx">err</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="nx">client</span><span class="p">.</span><span class="nx">UseDatabase</span><span class="p">(</span><span class="nx">ctx</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="nx">schema</span><span class="p">.</span><span class="nx">Database</span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="nx">Databasename</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;mydb&quot;</span><span class="p">,</span><span class="w"></span>
<span class="p">})</span><span class="w"></span>
<span class="k">if</span><span class="w"> </span><span class="nx">err</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="kc">nil</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="nx">log</span><span class="p">.</span><span class="nx">Fatal</span><span class="p">(</span><span class="nx">err</span><span class="p">)</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="c1">// do amazing stuff</span><span class="w"></span>

<span class="nx">_</span><span class="p">,</span><span class="w"> </span><span class="nx">err</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="nx">client</span><span class="p">.</span><span class="nx">UnloadDatabase</span><span class="p">(</span><span class="nx">ctx</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="nx">schema</span><span class="p">.</span><span class="nx">UnloadDatabaseRequest</span><span class="p">{</span><span class="nx">Database</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;mydb&quot;</span><span class="p">})</span><span class="w"></span>
<span class="k">if</span><span class="w"> </span><span class="nx">err</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="kc">nil</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="nx">log</span><span class="p">.</span><span class="nx">Fatal</span><span class="p">(</span><span class="nx">err</span><span class="p">)</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
</pre></div>
</div>
<p>:::</p>
<p>::: tab Java
This feature is not yet supported or not documented.
Do you want to make a feature request or help out? Open an issue on <a class="reference external" href="https://github.com/codenotary/immudb4j/issues/new">Java sdk github project</a>
:::</p>
<p>::: tab Python
This feature is not yet supported or not documented.
Do you want to make a feature request or help out? Open an issue on <a class="reference external" href="https://github.com/codenotary/immudb-py/issues/new">Python sdk github project</a>
:::</p>
<p>::: tab Node.js
This feature is not yet supported or not documented.
Do you want to make a feature request or help out? Open an issue on <a class="reference external" href="https://github.com/codenotary/immudb-node/issues/new">Node.js sdk github project</a>
:::</p>
<p>::: tab .Net
This feature is not yet supported or not documented.
Do you want to make a feature request or help out? Open an issue on <a class="reference external" href="https://github.com/codenotary/immudb4dotnet/issues/new">.Net sdk github project</a>
:::</p>
<p>::: tab Others
If you’re using another development language, please refer to the <a class="reference internal" href="immugw.html"><span class="doc std std-doc">immugw</span></a> option.
:::</p>
<p>::::</p>
</section>
<section id="database-settings">
<h3>Database settings<a class="headerlink" href="#database-settings" title="Permalink to this heading">¶</a></h3>
<p>Database settings can be individually changed using <code class="docutils literal notranslate"><span class="pre">UpdateDatabaseV2</span></code> method.</p>
<p>Each database can be configured with a variety of settings. While some values can be changed at any time (though it may require a database reload to take effect), following ones are fixed and cannot be changed: FileSize, MaxKeyLen, MaxValueLen, MaxTxEntries and IndexOptions.MaxNodeSize.</p>
<p>Note: Replication settings take effect without the need of reloading the database.</p>
<p>Following example shows how to update database using <code class="docutils literal notranslate"><span class="pre">UpdateDatabaseV2</span></code> method.</p>
<p>:::: tabs</p>
<p>::: tab Go</p>
<div class="highlight-go notranslate"><div class="highlight"><pre><span></span><span class="nx">client</span><span class="p">,</span><span class="w"> </span><span class="nx">err</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="nx">immudb</span><span class="p">.</span><span class="nx">NewClient</span><span class="p">()</span><span class="w"></span>
<span class="k">if</span><span class="w"> </span><span class="nx">err</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="kc">nil</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="nx">log</span><span class="p">.</span><span class="nx">Fatal</span><span class="p">(</span><span class="nx">err</span><span class="p">)</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="nx">ctx</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="nx">context</span><span class="p">.</span><span class="nx">Background</span><span class="p">()</span><span class="w"></span>
<span class="w">	</span>
<span class="nx">err</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="nx">client</span><span class="p">.</span><span class="nx">OpenSession</span><span class="p">(</span><span class="nx">ctx</span><span class="p">,</span><span class="w"> </span><span class="p">[]</span><span class="nb">byte</span><span class="p">(</span><span class="s">`immudb`</span><span class="p">),</span><span class="w"> </span><span class="p">[]</span><span class="nb">byte</span><span class="p">(</span><span class="s">`immudb`</span><span class="p">),</span><span class="w"> </span><span class="s">&quot;defaultdb&quot;</span><span class="p">)</span><span class="w"></span>
<span class="k">if</span><span class="w"> </span><span class="nx">err</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="kc">nil</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="nx">log</span><span class="p">.</span><span class="nx">Fatal</span><span class="p">(</span><span class="nx">err</span><span class="p">)</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="k">defer</span><span class="w"> </span><span class="nx">client</span><span class="p">.</span><span class="nx">CloseSession</span><span class="p">(</span><span class="nx">ctx</span><span class="p">)</span><span class="w"></span>

<span class="nx">res</span><span class="p">,</span><span class="w"> </span><span class="nx">err</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="nx">client</span><span class="p">.</span><span class="nx">UpdateDatabaseV2</span><span class="p">(</span><span class="nx">ctx</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;mydb&quot;</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="nx">schema</span><span class="p">.</span><span class="nx">DatabaseNullableSettings</span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="nx">TxLogCacheSize</span><span class="p">:</span><span class="w"> </span><span class="o">&amp;</span><span class="nx">schema</span><span class="p">.</span><span class="nx">NullableUint32</span><span class="p">{</span><span class="nx">Value</span><span class="p">:</span><span class="w"> </span><span class="mi">1000</span><span class="p">},</span><span class="w"></span>
<span class="p">})</span><span class="w"></span>
<span class="k">if</span><span class="w"> </span><span class="nx">err</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="kc">nil</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="nx">log</span><span class="p">.</span><span class="nx">Fatal</span><span class="p">(</span><span class="nx">err</span><span class="p">)</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
</pre></div>
</div>
<p>:::</p>
<p>::: tab Java
This feature is not yet supported or not documented.
Do you want to make a feature request or help out? Open an issue on <a class="reference external" href="https://github.com/codenotary/immudb4j/issues/new">Java sdk github project</a>
:::</p>
<p>::: tab Python
This feature is not yet supported or not documented.
Do you want to make a feature request or help out? Open an issue on <a class="reference external" href="https://github.com/codenotary/immudb-py/issues/new">Python sdk github project</a>
:::</p>
<p>::: tab Node.js
This feature is not yet supported or not documented.
Do you want to make a feature request or help out? Open an issue on <a class="reference external" href="https://github.com/codenotary/immudb-node/issues/new">Node.js sdk github project</a>
:::</p>
<p>::: tab .Net
This feature is not yet supported or not documented.
Do you want to make a feature request or help out? Open an issue on <a class="reference external" href="https://github.com/codenotary/immudb4dotnet/issues/new">.Net sdk github project</a>
:::</p>
<p>::: tab Others
If you’re using another development language, please refer to the <a class="reference internal" href="immugw.html"><span class="doc std std-doc">immugw</span></a> option.
:::</p>
<p>::::</p>
<br/>
</section>
</section>
<section id="index-cleaning">
<h2>Index cleaning<a class="headerlink" href="#index-cleaning" title="Permalink to this heading">¶</a></h2>
<p>Maintaining a healthy disk usage is crucial. immudb has two operations operations aiming to remove unreferenced data from the index.
A full index clean-up is achieved by calling <code class="docutils literal notranslate"><span class="pre">CompactIndex</span></code>, which is a routine that creates a fresh index based on the current state, removing all intermediate data generated over time. The index is generated asynchronously, so new transactions may take place while it is created. As a result, if the server is constantly overloaded, there will likely be blocking times when the newly compacted index replaces the current one.
In the case of continuous load on the server, the <code class="docutils literal notranslate"><span class="pre">FlushIndex</span></code> operation may be used instead. It will dump the current index into disk while partly removing unreferenced data. The <code class="docutils literal notranslate"><span class="pre">cleanupPercentage</span></code> attribute indicates how much space will be scanned for unreferenced data. Even though this operation blocks transaction processing, choosing a small percentage e.g. 0.1 may not significantly hinder normal operations while reducing used storage space.</p>
<p>Partially compaction may be triggered automatically by immudb. Database settings can be modified to set the <code class="docutils literal notranslate"><span class="pre">cleanupPercentage</span></code> attribute to non-zero in order to accomplish this.</p>
<blockquote>
<div><p>immudb uses a btree to index key-value entries. While the key is the same submitted by the client, the value stored in the btree is an offset to the file where the actual value as stored, its size and hash value.
The btree is keep in memory as new data is inserted, getting a key or even the historical values of a key can directly be made by using a mutex lock on the btree but scanning by prefix requires the tree to be stored into disk, this is referred as a snapshot.
The persistence is implemented in append-only mode, thus whenever a snapshot is created (btree flushed to disk), updated and new nodes are appended to the file, while new or updated nodes may be linked to unmodified nodes (already written into disk) and those unmodified nodes are not rewritten.
The snapshot creation does not necessarily take place upon each scan by prefix, it’s possible to reuse an already created one, client can provide his requirements on how new the snapshot should be by providing a transaction ID which at least must be indexed (sinceTx).
After some time, several snapshots may be created (specified by flushAfter properties of the btree and the scan requests), the file backing the btree will hold several old snapshots. Thus the clean index process will dump to a different location only the latest snapshot but in this case also writing the unmodified nodes. Once that dump is done, the index folder is replaced by the new one.
While the clean process is made, no data is indexed and there will be an extra disk space requirement due to the new dump. Once completed, a considerable disk space will be reduced by removing the previously indexed data (older snapshots).
The btree and clean up process is something specific to indexing. And will not lock transaction processing as indexing is asynchronously generated.</p>
</div></blockquote>
<p>:::: tabs</p>
<p>::: tab Go</p>
<div class="highlight-go notranslate"><div class="highlight"><pre><span></span><span class="c1">// full async index cleanup</span><span class="w"></span>
<span class="nx">err</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="nx">client</span><span class="p">.</span><span class="nx">CompactIndex</span><span class="p">(</span><span class="nx">ctx</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="nx">emptypb</span><span class="p">.</span><span class="nx">Empty</span><span class="p">{})</span><span class="w"></span>
<span class="c1">// error handling</span><span class="w"></span>

<span class="c1">// partial index cleanup</span><span class="w"></span>
<span class="nx">err</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="nx">client</span><span class="p">.</span><span class="nx">FlushIndex</span><span class="p">(</span><span class="nx">ctx</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="nx">schema</span><span class="p">.</span><span class="nx">FlushIndexRequest</span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="nx">CleanupPercentage</span><span class="p">:</span><span class="w"> </span><span class="mf">0.1</span><span class="p">,</span><span class="w"></span>
<span class="w">	</span><span class="nx">Synced</span><span class="p">:</span><span class="w">            </span><span class="kc">false</span><span class="p">,</span><span class="w"> </span><span class="c1">// if true, fsync after writing data to avoid index regeneration in the case of an unexpected crash</span><span class="w"></span>
<span class="c1">// error handling</span><span class="w"></span>
</pre></div>
</div>
<p>:::</p>
<p>::: tab Java</p>
<div class="highlight-java notranslate"><div class="highlight"><pre><span></span><span class="n">immuClient</span><span class="p">.</span><span class="na">cleanIndex</span><span class="p">();</span><span class="w"></span>
</pre></div>
</div>
<p>:::</p>
<p>::: tab Python
This feature is not yet supported or not documented.
Do you want to make a feature request or help out? Open an issue on <a class="reference external" href="https://github.com/codenotary/immudb-py/issues/new">Python sdk github project</a>
:::</p>
<p>::: tab Node.js
This feature is not yet supported or not documented.
Do you want to make a feature request or help out? Open an issue on <a class="reference external" href="https://github.com/codenotary/immudb-node/issues/new">Node.js sdk github project</a>
:::</p>
<p>::: tab .Net
This feature is not yet supported or not documented.
Do you want to make a feature request or help out? Open an issue on <a class="reference external" href="https://github.com/codenotary/immudb4dotnet/issues/new">.Net sdk github project</a>
:::</p>
<p>::: tab Others
If you’re using another development language, please refer to the <a class="reference internal" href="immugw.html"><span class="doc std std-doc">immugw</span></a> option.
:::</p>
<p>::::</p>
<br/>
</section>
<section id="healthcheck">
<h2>HealthCheck<a class="headerlink" href="#healthcheck" title="Permalink to this heading">¶</a></h2>
<p>HealthCheck return an error if <code class="docutils literal notranslate"><span class="pre">immudb</span></code> status is not ok.
:::: tabs
::: tab Go</p>
<div class="highlight-go notranslate"><div class="highlight"><pre><span></span><span class="nx">err</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="nx">client</span><span class="p">.</span><span class="nx">HealthCheck</span><span class="p">(</span><span class="nx">ctx</span><span class="p">)</span><span class="w"></span>
</pre></div>
</div>
<p>:::</p>
<p>::: tab Java</p>
<div class="highlight-java notranslate"><div class="highlight"><pre><span></span><span class="kt">boolean</span><span class="w"> </span><span class="n">isHealthy</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">immuClient</span><span class="p">.</span><span class="na">healthCheck</span><span class="p">();</span><span class="w"></span>
</pre></div>
</div>
<p>:::</p>
<p>::: tab Python</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">immudb</span> <span class="kn">import</span> <span class="n">ImmudbClient</span>

<span class="n">URL</span> <span class="o">=</span> <span class="s2">&quot;localhost:3322&quot;</span>  <span class="c1"># immudb running on your machine</span>
<span class="n">LOGIN</span> <span class="o">=</span> <span class="s2">&quot;immudb&quot;</span>        <span class="c1"># Default username</span>
<span class="n">PASSWORD</span> <span class="o">=</span> <span class="s2">&quot;immudb&quot;</span>     <span class="c1"># Default password</span>
<span class="n">DB</span> <span class="o">=</span> <span class="sa">b</span><span class="s2">&quot;defaultdb&quot;</span>       <span class="c1"># Default database name (must be in bytes)</span>

<span class="k">def</span> <span class="nf">main</span><span class="p">():</span>
    <span class="n">client</span> <span class="o">=</span> <span class="n">ImmudbClient</span><span class="p">(</span><span class="n">URL</span><span class="p">)</span>
    <span class="n">client</span><span class="o">.</span><span class="n">login</span><span class="p">(</span><span class="n">LOGIN</span><span class="p">,</span> <span class="n">PASSWORD</span><span class="p">,</span> <span class="n">database</span> <span class="o">=</span> <span class="n">DB</span><span class="p">)</span>
    <span class="n">check</span> <span class="o">=</span> <span class="n">client</span><span class="o">.</span><span class="n">healthCheck</span><span class="p">()</span>    <span class="c1"># Returns bool</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">check</span><span class="p">)</span>                    <span class="c1"># True</span>

<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>
    <span class="n">main</span><span class="p">()</span>
</pre></div>
</div>
<p>:::</p>
<p>::: tab Node.js</p>
<div class="highlight-ts notranslate"><div class="highlight"><pre><span></span><span class="k">import</span><span class="w"> </span><span class="nx">ImmudbClient</span><span class="w"> </span><span class="kr">from</span><span class="w"> </span><span class="s1">&#39;immudb-node&#39;</span><span class="w"></span>

<span class="kd">const</span><span class="w"> </span><span class="nx">IMMUDB_HOST</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;127.0.0.1&#39;</span><span class="w"></span>
<span class="kd">const</span><span class="w"> </span><span class="nx">IMMUDB_PORT</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;3322&#39;</span><span class="w"></span>
<span class="kd">const</span><span class="w"> </span><span class="nx">IMMUDB_USER</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;immudb&#39;</span><span class="w"></span>
<span class="kd">const</span><span class="w"> </span><span class="nx">IMMUDB_PWD</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;immudb&#39;</span><span class="w"></span>

<span class="kd">const</span><span class="w"> </span><span class="nx">cl</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="nx">ImmudbClient</span><span class="p">({</span><span class="w"> </span><span class="nx">host</span><span class="o">:</span><span class="w"> </span><span class="kt">IMMUDB_HOST</span><span class="p">,</span><span class="w"> </span><span class="nx">port</span><span class="o">:</span><span class="w"> </span><span class="kt">IMMUDB_PORT</span><span class="w"> </span><span class="p">});</span><span class="w"></span>

<span class="p">(</span><span class="k">async</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">	</span><span class="k">await</span><span class="w"> </span><span class="nx">cl</span><span class="p">.</span><span class="nx">login</span><span class="p">({</span><span class="w"> </span><span class="nx">user</span><span class="o">:</span><span class="w"> </span><span class="kt">IMMUDB_USER</span><span class="p">,</span><span class="w"> </span><span class="nx">password</span><span class="o">:</span><span class="w"> </span><span class="kt">IMMUDB_PWD</span><span class="w"> </span><span class="p">})</span><span class="w"></span>

<span class="w">	</span><span class="k">await</span><span class="w"> </span><span class="nx">cl</span><span class="p">.</span><span class="nx">health</span><span class="p">()</span><span class="w"></span>
<span class="p">})()</span><span class="w"></span>
</pre></div>
</div>
<p>:::</p>
<p>::: tab .Net
This feature is not yet supported or not documented.
Do you want to make a feature request or help out? Open an issue on <a class="reference external" href="https://github.com/codenotary/immudb4dotnet/issues/new">.Net sdk github project</a>
:::</p>
<p>::: tab Others
If you’re using another development language, please refer to the <a class="reference internal" href="immugw.html"><span class="doc std std-doc">immugw</span></a> option.
:::</p>
<p>::::</p>
</section>
</section>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="../index.html">Immudb</a></h1>








<h3>Navigation</h3>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../index.html">Documentation overview</a><ul>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>document.getElementById('searchbox').style.display = "block"</script>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2022, Codenotary.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 5.0.2</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.12</a>
      
      |
      <a href="../_sources/develop/management.md.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>